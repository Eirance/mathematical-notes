\section{西尔维斯特不等式}
\begin{theorem}
设\(\A \in M_{s \times n}(K),
\B \in M_{n \times t}(K)\)，
则\begin{equation}\label{equation:线性方程组.西尔维斯特不等式}
	\rank\A + \rank\B - n \leq \rank(\A\B).
\end{equation}
当且仅当\[
	\rank\begin{bmatrix}
		\A & \vb0 \\
		\E_n & \B
	\end{bmatrix}
	= \rank\begin{bmatrix}
		\A & \vb0 \\
		\vb0 & \B
	\end{bmatrix}
\]时，
\cref{equation:线性方程组.西尔维斯特不等式} 取“=”号.
\begin{proof}
由\cref{equation:矩阵的秩.分块矩阵的秩的等式1}，\[
	\rank\begin{bmatrix}
		\E_n & \z \\
		\z & \A\B
	\end{bmatrix}
	= n + \rank(\A\B).
	\eqno(1)
\]
又因为\[
	\begin{bmatrix}
		\B & \E_n \\
		\z & \A
	\end{bmatrix}
	= \begin{bmatrix}
		\E_n & \z \\
		\A & \E_s
	\end{bmatrix}
	\begin{bmatrix}
		\E_n & \z \\
		\z & \A\B
	\end{bmatrix}
	\begin{bmatrix}
		\E_n & -\B \\
		\z & \E_t
	\end{bmatrix}
	\begin{bmatrix}
		\z & \E_s \\
		-\E_t & \z
	\end{bmatrix},
\]
而\[
	\begin{bmatrix}
		\E_n & \z \\
		\A & \E_s
	\end{bmatrix}, \qquad
	\begin{bmatrix}
		\E_n & -\B \\
		\z & \E_t
	\end{bmatrix},
	\quad\text{和}\quad
	\begin{bmatrix}
		\z & \E_s \\
		-\E_t & \z
	\end{bmatrix}
\]这三个矩阵都是满秩矩阵，
所以\[
	\rank\begin{bmatrix}
		\E_n & \z \\
		\z & \A\B
	\end{bmatrix}
	= \rank\begin{bmatrix}
		\B & \E_n \\
		\z & \A
	\end{bmatrix}.
	\eqno(2)
\]
再由\cref{equation:矩阵的秩.分块矩阵的秩的不等式} 有\[
	\rank\begin{bmatrix}
		\B & \E_n \\
		\z & \A
	\end{bmatrix}
	\geq \rank\A+\rank\B.
	\eqno(3)
\]
因此，\(\rank\A + \rank\B \leq n + \rank(\A\B)\).
%@see: https://math.stackexchange.com/a/2414197/591741
%@see: http://www.m-hikari.com/imf-password2009/33-36-2009/luIMF33-36-2009.pdf
\end{proof}
\end{theorem}

我们把\cref{equation:线性方程组.西尔维斯特不等式} 称为\DefineConcept{西尔维斯特不等式}.

进一步，如果有\(\A\B=\z\)，
那么\(\rank\A + \rank\B \leq n\).

我们可以利用\hyperref[equation:线性方程组.西尔维斯特不等式]{西尔维斯特不等式}证明一个重要结论：
\begin{proposition}\label{theorem:向量空间.用列满秩矩阵左乘任一矩阵不变秩}
设\(\A \in M_{s \times n}(K),
\B \in M_{m \times s}(K)\).
如果\(\B\)是列满秩矩阵，则\(\rank(\B\A) = \rank\A\).
\begin{proof}
假设\(\B\)是列满秩矩阵，
即\(\rank\B = s\).
由\hyperref[equation:线性方程组.西尔维斯特不等式]{西尔维斯特不等式}有\[
	\rank(\B\A) \geq \rank\A + \rank\B - s
	= \rank\A. % 代入\(\rank\B = s\)
	\eqno(1)
\]
又由\cref{theorem:线性方程组.矩阵乘积的秩} 可知\[
	\rank(\B\A) \leq \rank\A.
	\eqno(2)
\]
由(1)(2)两式便有\(\rank(\B\A) = \rank\A\).
\end{proof}
\end{proposition}
\begin{remark}
\cref{theorem:向量空间.用列满秩矩阵左乘任一矩阵不变秩} 说明：
对于任意一个矩阵，我们用一个列满秩矩阵左乘它，不变秩.
同理，我们还可以证明：
对于任意一个矩阵，我们用一个行满秩矩阵右乘它，也不变秩.
我们只要把\cref{theorem:向量空间.用列满秩矩阵左乘任一矩阵不变秩} 中的各个矩阵转置，
得到\(\A_1 = \A^T \in M_{n \times s}(K),
\B_1 = \B^T \in M_{s \times m}(K),
\A_1\B_1 = \A^T\B^T = (\B\A)^T\)，
易见\(\B_1\)是行满秩矩阵，且\[
	\rank(\A_1\B_1)
	= \rank(\B\A)^T
	= \rank(\B\A)
	= \rank\A
	= \rank\A^T.
\]
\end{remark}

\begin{example}
%@see: 《高等代数（第三版 上册）》（丘维声） P143 习题4.5 9.
设\(\A\)为\(n\ (n>1)\)阶方阵，\(\A^*\)是\(\A\)的伴随矩阵.
证明：\[
	\rank\A^* = \left\{ \begin{array}{cl}
		n, & \rank\A=n, \\
		1, & \rank\A=n-1, \\
		0, & \rank\A<n-1.
	\end{array} \right.
\]
\begin{proof}
根据恒等式 \labelcref{equation:行列式.伴随矩阵.恒等式1} 有\[
	\A \A^* = \abs{\A} \E,
	\eqno(1)
\]
于是\[
	\abs{\A \A^*} = \abs{\abs{\A} \E}.
	\eqno(2)
\]
根据\cref{theorem:行列式.矩阵乘积的行列式}，
(2)式左边可以分解为\[
	\abs{\A \A^*} = \abs{\A} \abs{\A^*}.
\]
根据\cref{theorem:行列式.性质2.推论2}，
(2)式右边可以分解为\[
	\abs{\abs{\A} \E} = \abs{\A}^n \abs{\E} = \abs{\A}^n.
\]
于是我们得到\[
	\abs{\A} \abs{\A^*} = \abs{\A}^n.
	\eqno(3)
\]

下面我们根据矩阵\(\A\)的秩的取值分类讨论.
\begin{enumerate}
	\item 当\(\rank\A = n\)时，
	由\cref{theorem:向量空间.满秩方阵的行列式非零} 有\(\abs{\A} \neq 0\)；
	于是(3)式可化简得\[
		\abs{\A^*}
		= \abs{\A}^{n-1} \neq 0,
	\]
	再次利用\cref{theorem:向量空间.满秩方阵的行列式非零} 便知\(\rank\A^* = n\).

	\item 当\(\rank\A = n-1\)时，
	因为\(\rank\A<n\)，
	所以\(\abs{\A} = 0\)，
	那么由(1)式可知\(\A \A^* = \z\)，
	那么利用\hyperref[equation:线性方程组.西尔维斯特不等式]{西尔维斯特不等式}便得\[
		\rank\A + \rank\A^* \leq n,
	\]
	移项得\[
		\rank\A^*
		\leq n - \rank\A
		= n - (n-1)
		= 1.
	\]
	又因为\(n > 1\)，
	\(\rank\A = n-1 > 0\)，
	根据矩阵的秩的定义，\(\A\)有一个\(n-1\)阶子式不等于零，
	再根据伴随矩阵的定义，这个子式是\(\A^*\)的一个元素，从而\(\A^*\neq\z\)，
	\(\rank\A^*>0\).
	因此\(\rank\A^* = 1\).

	\item 当\(\rank\A < n-1\)时，
	\(\A\)的所有\(n-1\)阶子式全为零，
	也就是说\(\A\)的任意一个元素的代数余子式为零，
	根据伴随矩阵的定义，\(\A^* = \z\)，
	因此\(\rank\A^* = 0\).
	\qedhere
\end{enumerate}
\end{proof}
\end{example}

我们还可以将\hyperref[equation:线性方程组.西尔维斯特不等式]{西尔维斯特不等式}进行如下的推广.
\begin{theorem}
设\(\A \in M_{s \times n}(K),
\B \in M_{n \times m}(K),
\C \in M_{m \times t}(K)\)，
则\begin{equation}\label{equation:线性方程组.弗罗贝尼乌斯不等式}
	\rank(\A\B\C) \geq \rank(\A\B) + \rank(\B\C) - \rank\B.
\end{equation}
\begin{proof}
利用初等变换，有\[
	\begin{bmatrix}
		\B & \z \\
		\z & \A\B\C
	\end{bmatrix}
	\to \begin{bmatrix}
		\B & \z \\
		\A\B & \A\B\C
	\end{bmatrix}
	\to \begin{bmatrix}
		\B & -\B\C \\
		\A\B & \z
	\end{bmatrix}
	\to \begin{bmatrix}
		\B\C & \B \\
		\z & \A\B
	\end{bmatrix},
\]
于是\[
	\rank\B + \rank(\A\B\C)
	= \rank\begin{bmatrix}
		\B & \z \\
		\z & \A\B\C
	\end{bmatrix}
	= \rank\begin{bmatrix}
		\B\C & \B \\
		\z & \A\B
	\end{bmatrix}
	\geq \rank(\A\B) + \rank(\B\C).
	\qedhere
\]
\end{proof}
\end{theorem}

我们把\cref{equation:线性方程组.弗罗贝尼乌斯不等式} 称为“弗罗贝尼乌斯不等式”.

\begin{example}
%@see: 《高等代数（第三版 上册）》（丘维声） P143 习题4.5 4.
证明：如果\(n\)阶矩阵\(\A\)是\DefineConcept{对合矩阵}，
即满足\(\A^2=\E\)，
则\[
	\rank(\E+\A)+\rank(\E-\A)=n.
\]
\begin{proof}
因为利用初等变换可以得到\begin{align*}
	&\hspace{-20pt}
	\begin{bmatrix}
		\E+\A & \z \\
		\z & \E-\A
	\end{bmatrix}
	\to \begin{bmatrix}
		\E+\A & \z \\
		\A(\E+\A) & \E-\A
	\end{bmatrix}
	= \begin{bmatrix}
		\E+\A & \z \\
		\A+\E & \E-\A
	\end{bmatrix} \\
	&\to \begin{bmatrix}
		\E+\A & \E-\A \\
		\z & \z
	\end{bmatrix}
	\to \begin{bmatrix}
		\E+\A & 2\E \\
		\z & \z
	\end{bmatrix}
	\to \begin{bmatrix}
		\E+\A & \E \\
		\z & \z
	\end{bmatrix}
	\to \begin{bmatrix}
		\A & \E \\
		\z & \z
	\end{bmatrix},
\end{align*}
所以\[
	\rank(\E+\A)+\rank(\E-\A)
	=\rank\begin{bmatrix}
		\E+\A & \z \\
		\z & \E-\A
	\end{bmatrix}
	= \rank\begin{bmatrix}
		\A & \E \\
		\z & \z
	\end{bmatrix}
	= n.
	\qedhere
\]
\end{proof}
\end{example}

\begin{example}
%@see: 《高等代数（第三版 上册）》（丘维声） P143 习题4.5 5.
证明：如果\(n\)阶矩阵\(\A\)是\DefineConcept{幂等矩阵}（idempotent matrix），
即满足\(\A^2=\A\)，
则\[
	\rank\A+\rank(\E-\A)=n.
\]
\begin{proof}
由于\[
	\A^2=\A
	\iff
	\A^2-\A=\z
	\iff
	\rank(\A^2-\A)=0.
\]
又因为利用初等变换可以得到\[
	\begin{bmatrix}
		\A & \z \\
		\z & \E_n-\A
	\end{bmatrix}
	\to \begin{bmatrix}
		\A & \z \\
		\A & \E_n-\A
	\end{bmatrix}
	\to \begin{bmatrix}
		\A & \A \\
		\A & \E_n
	\end{bmatrix}
	\to \begin{bmatrix}
		\A-\A^2 & \z \\
		\A & \E_n
	\end{bmatrix}
	\to \begin{bmatrix}
		\A-\A^2 & \z \\
		\z & \E_n
	\end{bmatrix},
\]
所以\(\rank\A+\rank(\E_n-\A)
=\rank(\A-\A^2)+n
=n\).
\end{proof}
\end{example}

\begin{example}
设\(\A \in M_{m \times n}(K)\).
证明：\[
	\rank(\E_m-\A\A^T)-\rank(\E_n-\A^T\A)=m-n.
\]
\begin{proof}
因为利用初等变换可以得到\begin{align*}
	\begin{bmatrix}
		\E_m-\A\A^T & \z \\
		\z & \E_n
	\end{bmatrix}
	&\to \begin{bmatrix}
		\E_m-\A\A^T & \A \\
		\z & \E_n
	\end{bmatrix}
	\to \begin{bmatrix}
		\E_m & \A \\
		\A^T & \E_n
	\end{bmatrix} \\
	&\to \begin{bmatrix}
		\E_m & \z \\
		\A^T & \E_n-\A^T\A
	\end{bmatrix}
	\to \begin{bmatrix}
		\E_m & \z \\
		\z & \E_n-\A^T\A
	\end{bmatrix},
\end{align*}
所以\[
	\rank(\E_m-\A\A^T)+n=m+\rank(\E_n-\A^T\A),
\]
移项便得\(\rank(\E_m-\A\A^T)-\rank(\E_n-\A^T\A)=m-n\).
\end{proof}
\end{example}

\begin{example}
设\(\A,\B,\C \in M_n(K)\)，
\(\rank\C=n\)，
\(\A(\B\A+\C)=\z\).
证明：\[
	\rank(\B\A+\C)=n-\rank\A.
\]
\begin{proof}
因为\(\A(\B\A+\C)=\z\)，
所以根据\cref{equation:线性方程组.西尔维斯特不等式} 有\[
	\rank(\B\A+\C)+\rank\A \leq n.
\]
又利用初等变换可以得到\[
	\begin{bmatrix}
		\B\A+\C & \z \\
		\z & \A
	\end{bmatrix}
	\to \begin{bmatrix}
		\B\A+\C & \B\A \\
		\z & \A
	\end{bmatrix}
	\to \begin{bmatrix}
		\C & \B\A \\
		-\A & \A
	\end{bmatrix},
\]
于是\[
	\rank(\B\C+\C)
	+\rank\A
	= \rank\begin{bmatrix}
		\B\A+\C & \z \\
		\z & \A
	\end{bmatrix}
	= \rank\begin{bmatrix}
		\C & \B\A \\
		-\A & \A
	\end{bmatrix}
	\geq \rank\C = n.
	\qedhere
\]
\end{proof}
\end{example}
