\section{矩阵乘积的秩}
令\[
	\A=\begin{bmatrix}
		1 & 0 \\
		0 & 0
	\end{bmatrix}, \qquad
	\B=\begin{bmatrix}
		0 & 0 \\
		1 & 0
	\end{bmatrix}, \qquad
	\C=\begin{bmatrix}
		1 & 1 \\
		0 & 1
	\end{bmatrix},
\]
则\[
	\A\B=\begin{bmatrix}
		1 & 0 \\
		0 & 0
	\end{bmatrix}
	\begin{bmatrix}
		0 & 0 \\
		1 & 0
	\end{bmatrix}
	= \begin{bmatrix}
		0 & 0 \\
		0 & 0
	\end{bmatrix};
\]
于是\(\rank(\A\B)=0\)，而\(\rank\A=1\)，\(\rank\B=1\).

又\[
	\A\C=\begin{bmatrix}
		1 & 0 \\
		0 & 0
	\end{bmatrix}
	\begin{bmatrix}
		1 & 1 \\
		0 & 1
	\end{bmatrix}
	= \begin{bmatrix}
		1 & 1 \\
		0 & 0
	\end{bmatrix};
\]
于是\(\rank(\A\C)=1\)，而\(\rank\A=1\)，\(\rank\C=2\).

从上述例子，我们猜测：
对于任意矩阵\(\A,\B\)，总有\[
	\rank(\A\B) \leq \rank\A, \qquad
	\rank(\A\B) \leq \rank\B.
\]

\begin{theorem}\label{theorem:线性方程组.矩阵乘积的秩}
%@see: 《线性代数》（张慎语、周厚隆） P78 定理7
%@see: 《高等代数（第三版 上册）》（丘维声） P121 定理1
设\(\A\in M_{s\times n}(K),
\B\in M_{n\times m}(K)\)，
那么\[
	\rank(\A\B) \leq \min\{\rank\A,\rank\B\}.
\]
\begin{proof}
记\(\C = \A\B\)，
显然\(\rank(\A\B)=\rank_C\C\).
将\(\C\)、\(\B\)分别进行列分块得\[
	\C = (\AutoTuple{\g}{n}),
	\qquad
	\B = (\AutoTuple{\b}{n}),
\]
则\[
	(\AutoTuple{\g}{n}) = \A (\AutoTuple{\b}{n}) = (\AutoTuple{\A\b}{n}),
\]
于是\(\g_i = \A \b_i\ (i=1,2,\dotsc,n)\).

假设\(\rank\B = t<m\)，
那么由\cref{example:向量空间.若部分组向量个数多于全组的秩则部分组必线性相关}，
\(\B\)的任意\(t+1\)个列向量\(\b_{k_1},\b_{k_2},\dotsc,\b_{k_{t+1}}\)线性相关，
也就是说，存在不全为零的数\(l_1,l_2,\dotsc,l_{t+1}\in K\)，使得\[
	l_1 \b_{k_1} + l_2 \b_{k_2} + \dotsb + l_{t+1} \b_{k_{t+1}} = \z.
\]
因此\[
	l_1 \g_{k_1} + l_2 \g_{k_2} + \dotsb + l_{t+1} \g_{k_{t+1}}
	= \A(l_1 \b_{k_1} + l_2 \b_{k_2} + \dotsb + l_{t+1} \b_{k_{t+1}})
	= \z,
\]
这就是说\(\C\)的任意\(t+1\)个列向量也线性相关，
那么\(\rank_C\C \ngeq t+1\)，
\(\rank(\A\B)\leq t\)，
即\(\rank(\A\B) \leq \rank\B\).
利用这个结论，我们还可以得到\[
	\rank(\A\B)
	= \rank(\A\B)^T
	= \rank(\B^T \A^T)
	\leq \rank \A^T
	= \rank \A.
\]
综上所述\(\rank(\A\B) \leq \min\{\rank\A,\rank\B\}\).
\end{proof}
\end{theorem}

\begin{corollary}
设\(\A\)是一个\(s \times n\)矩阵，
\(\P\)、\(\Q\)分别是\(s\)阶和\(n\)阶可逆矩阵，
则\[
	\rank\A = \rank(\P\A) = \rank(\A\Q) = \rank(\P\A\Q).
\]
\begin{proof}
因为\(\A = (\P^{-1} \P) \A = \P^{-1} (\P \A)\)，
由\cref{theorem:线性方程组.矩阵乘积的秩}，
有\[
	\rank\A = \rank(\P^{-1}(\P\A)) \leq \rank(\P\A) \leq \rank\A,
\]
所以\(\rank\A = \rank(\P\A)\).
同理可得\(\rank\A = \rank(\A\Q) = \rank(\P\A\Q)\).
\end{proof}
\end{corollary}

\begin{theorem}
设矩阵\(\A \in M_{m \times n}(K),
\B \in M_{n \times m}(K)\).
如果\(m > n\)，
那么\(\abs{\A\B} = 0\).
\begin{proof}
当\(m>n\)时，
根据\cref{theorem:线性方程组.矩阵的秩的性质2}，有\[
	\rank\A,\rank\B \leq \min\{m,n\} = n;
\]
再根据\cref{theorem:线性方程组.矩阵乘积的秩}，有\[
	\rank(\A\B) \leq \min\{\rank\A,\rank\B\} = n < m,
\]
也就是说，矩阵\(\A\B\)不满秩；
那么根据\cref{theorem:向量空间.满秩方阵的行列式非零} 可知\(\abs{\A\B} = 0\).
\end{proof}
\end{theorem}

\begin{definition}
设矩阵\(\A \in M_{s \times n}(K)\)，
\(\rank\A = r\)，
\(\E_r\)是\(r\)阶单位矩阵.
我们把分块矩阵\[
	\begin{bmatrix}
		\E_r & \vb0 \\
		\vb0 & \vb0
	\end{bmatrix}
\]
称为“\(\A\)的\DefineConcept{等价标准型}”.
\end{definition}

下面我们证明任意一个矩阵的等价标准型总是存在.
\begin{theorem}\label{theorem:矩阵乘积的秩.等价标准型的存在性}
矩阵\(\A\)满足\(\rank\A=r\)的充分必要条件是：
存在可逆矩阵\(\P,\Q\)，使得\[
	\P \A \Q
	= \begin{bmatrix}
		\E_r & \vb0 \\
		\vb0 & \vb0
	\end{bmatrix} = \B.
\]
\begin{proof}
充分性.如果可逆矩阵\(\P,\Q\)使得\[
	\P\A\Q
	= \begin{bmatrix}
		\E_r & \vb0 \\
		\vb0 & \vb0
	\end{bmatrix},
\]
把上式等号左边的可逆矩阵\(\P\)、\(\Q\)分别视作对矩阵\(\A\)的初等行变换和初等列变换，
那么，根据\cref{theorem:线性方程组.初等变换不变秩}，
所得矩阵\(\B\)的秩与原矩阵\(\A\)相同，
即\[
	\rank\A = \rank\B = r.
	\qedhere
\]
%\cref{theorem:线性方程组.非零矩阵可经初等行变换化为若尔当阶梯形矩阵}
\end{proof}
\end{theorem}

\begin{theorem}
设\(\A\)与\(\B\)都是\(s \times n\)矩阵，
则\(\A \cong \B\)的充分必要条件是：
\(\rank\A = \rank\B\).
\begin{proof}
必要性.因为\(\A\)可经一系列初等变换化为\(\B\)，
根据\cref{theorem:线性方程组.初等变换不变秩}，初等变换不改变矩阵的秩，
所以\(\rank\A = \rank\B\).

充分性.已知\(\rank\A = \rank\B = r\).
对\(\A\)作初等行变换可将其化简为仅前\(r\)行不为零的阶梯形矩阵\(\C\)，
同样对\(\C\)作初等列变换可化简为\(\A\)的等价标准型.
对\(\B\)也可作初等变换化为等价标准型.
那么存在\(s\)阶可逆矩阵\(\P_1\)和\(\P_2\)，
存在\(n\)阶可逆矩阵\(\Q_1\)和\(\Q_2\)，
使得\[
	\P_1 \A \Q_1 = \P_2 \A \Q_2
	= \begin{bmatrix} \E_r & \z \\ \z & \z \end{bmatrix},
\]
令\(\P = \P_2^{-1} \P_1\)，\(\Q = \Q_1 \Q_2^{-1}\)，
则\(\P\)和\(\Q\)可逆，
\(\P \A \Q = \B\)，
从而\(\A \cong \B\).
\end{proof}
\end{theorem}

\begin{example}
设\(\A,\B\in M_n(K)\)，\(\A\B=\B\A\)，证明：\[
	\rank(\A+\B)\leq\rank\A+\rank\B-\rank(\A\B).
\]
\begin{proof}
考虑\[
	\begin{bmatrix}
		\E & \E \\
		\z & \E
	\end{bmatrix}
	\begin{bmatrix}
		\A & \z \\
		\z & \B
	\end{bmatrix}
	\begin{bmatrix}
		\E & -\B \\
		\E & \A
	\end{bmatrix}
	= \begin{bmatrix}
		\A+\B & -\A\B+\B\A \\
		\B & \B\A
	\end{bmatrix}
	= \begin{bmatrix}
		\A+\B & \z \\
		\B & \A\B
	\end{bmatrix}.
\]
由\cref{equation:矩阵的秩.分块矩阵的秩的等式1} 可知\[
	\rank\A+\rank\B
	= \rank\begin{bmatrix}
		\A & \z \\
		\z & \B
	\end{bmatrix}
	\geq \rank\begin{bmatrix}
		\A+\B & \z \\
		\B & \B\A
	\end{bmatrix}
	\geq \rank(\A+\B) + \rank(\A\B).
	\qedhere
\]
\end{proof}
\end{example}

\begin{example}\label{example:矩阵乘积的秩.两个向量的乘积的秩}
设\(\a,\b\)是\(n\)维非零列向量.
证明：\(\rank(\a\b^T)=1\).
\begin{proof}
因为\(\a,\b\neq\vb0\)，
所以\(\rank\a=\rank\b=1\)，
且\(\a\b^T\neq\vb0\)，
从而\(\rank(\a\b^T)>0\)，
再根据\cref{theorem:线性方程组.矩阵乘积的秩} 可知
\(\rank(\a\b^T)
\leq \min\{\rank\a,\rank\b^T\}
= 1\)，
因此\(\rank(\a\b^T)=1\).
\end{proof}
\end{example}

\begin{example}
设\(\A \in M_{s \times n}(K),
\B \in M_{s \times m}(K)\).
证明：\begin{equation}
	\rank(\A,\B) \leq \rank\A + \rank\B.
\end{equation}
\begin{proof}
\def\as{\AutoTuple{\a}{n}}
\def\bs{\AutoTuple{\b}{m}}
\def\asi{\a_{i_1},\dotsc,\a_{i_r}}
\def\bsj{\b_{j_1},\dotsc,\b_{j_t}}
设\(\rank\A = r,
\rank\B = t\).
对\(\A\)、\(\B\)分别按列分块得\[
	\A = (\as),
	\qquad
	\B = (\bs).
\]
易见\[
	(\A,\B) = (\as,\bs),
\]且\[
	\rank\{\as\} = r,
	\qquad
	\rank\{\bs\} = t.
\]

假设\(\as\)可由其极大线性无关组\(\asi\)线性表出，
\(\bs\)可由其极大线性无关组\(\bsj\)线性表出，
那么向量组\[
	V_1=\{\as\}\cup\{\bs\}
\]可由向量组\[
	V_2=\{\asi\}\cup\{\bsj\}
\]线性表出，
即\(V_1 \subseteq \Span V_2\)，
则由\cref{theorem:向量空间.向量组的秩的比较} 有\[
	\rank V_1
	\leq
	\rank V_2
	\leq
	r+t;
\]
于是\(\rank(\A,\B) = \rank V_1 \leq r+t\).
\end{proof}
\end{example}

\begin{example}
设\(\A\)、\(\B\)都是\(s \times n\)矩阵，证明：\(\rank(\A+\B) \leq \rank\A + \rank\B\).
\begin{proof}
\def\asi{\a_{i_1},\a_{i_2},\dotsc,\a_{i_r}}
\def\bsj{\b_{j_1},\b_{j_2},\dotsc,\b_{j_t}}
设\(\rank\A = r\)，\(\rank\B = t\).对\(\A\)、\(\B\)分别按列分块得\[
\A = (\AutoTuple{\a}{n}), \qquad
\B = (\AutoTuple{\b}{m}),
\]则\[
\A + \B = (\a_1 + \b_1,\a_2 + \b_2,\dotsc,\a_n + \b_n).
\]
由于\(\AutoTuple{\a}{n}\)可由其极大线性无关组\(\asi\)线性表出，
\(\AutoTuple{\b}{m}\)可由其极大线性无关组\(\bsj\)线性表出，
故\[
\a_1 + \b_1,\a_2 + \b_2,\dotsc,\a_n + \b_n
\]可由向量组\[
\asi,\bsj
\]线性表出，
结论显然成立.
\end{proof}
\end{example}

\begin{example}
设\(\A\)是\(n\)阶矩阵，证明：\(n \leq \rank(\A + \E) + \rank(\A - \E)\).
\begin{proof}
可以证
\begin{align*}
	\rank(\A + \E) + \rank(\A - \E)
	&= \rank(\A + \E) + \rank[-(\A - \E)] \\
	&\geq \rank\{(\A + \E) + [-(\A - \E)]\} \\
	&= \rank(2\E) = \rank\E = n.
	\qedhere
\end{align*}
\end{proof}
\end{example}

\begin{example}
设\(n\)阶矩阵\(\A\)满足\(\A^2 - 3 \A - 10 \E = \z\)，证明：\[
	\rank(\A - 5\E) + \rank(\A + 2\E) = n.
\]
\begin{proof}
因为\(\A\)满足\(\A^2 - 3 \A - 10 \E = (\A - 5\E)(\A + 2\E) = \z\)，所以\[
	\rank(\A - 5\E) + \rank(\A + 2\E) \leq n.
\]
又因为\begin{align*}
	&\rank(\A - 5\E) + \rank(\A + 2\E) \\
	&\geq \max\{
		\rank[(\A - 5\E) + (\A + 2\E)],
		\rank[(5\E - \A) + (\A + 2\E)]
		\} \\
	&= \max\{ \rank(2\A - 3\E),\rank(7\E) \}
	= n,
\end{align*}
所以\(\rank(\A - 5\E) + \rank(\A + 2\E) = n\).
\end{proof}
\end{example}

\begin{example}
设\(\A \in M_{s \times n}(K)\ (s \neq n)\).
证明：\(\det(\A \A^T) \det(\A^T \A) = 0\).
\begin{proof}
由题有，\(\A^T \A\)是\(n\)阶矩阵，\(\A \A^T\)是\(s\)阶矩阵.

当\(s < n\)时，\(\rank(\A^T \A) \leq \min\{ \rank\A, \rank\A^T \} = \rank\A = \rank\A^T \leq \min\{s,n\} = s < n\)，\(n\)阶方阵\(\A^T \A\)不满秩，那么\(\det(\A^T \A) = 0\).

同理，当\(n < s\)时，\(\rank(\A \A^T) \leq \min\{s,n\} = n < s\)，那么\(\det(\A \A^T) = 0\).

综上所述，\(s \neq n\)时总有\(\det(\A \A^T) \det(\A^T \A) = 0\).
\end{proof}
\end{example}

\begin{example}
设\(\A\)是\(m \times n\)矩阵，\(\B\)是\(n \times m\)矩阵，\(\E\)是\(m\)阶单位矩阵.
已知\(\A\B = \E\)，求\(\rank\A,\rank\B\).
\begin{solution}
假设\(m > n\)，则由\cref{theorem:线性方程组.矩阵的秩的性质2} 可知\[
\rank\A,\rank\B \leq \min\{m,n\} = n.
\]再由\cref{theorem:线性方程组.矩阵乘积的秩} 可知\[
\rank(\A\B) \leq \min\{\rank\A,\rank\B\} \leq n < m.
\]但\(\rank(\A\B) = \rank\E = m\)，矛盾！
由此可知，必有\(m \leq n\)，那么\[
\rank\A,\rank\B \leq \min\{m,n\} = m,
\]因此\begin{align*}
m = \rank(\A\B) \leq \min\{\rank\A,\rank\B\} \leq m
&\implies
\min\{\rank\A,\rank\B\} = m \\
&\implies
m \leq \rank\A,\rank\B \leq m \\
&\implies \rank\A=\rank\B=m.
\end{align*}
\end{solution}
\end{example}

\begin{example}
计算行列式\(\det\D\)，其中\[
\D = \begin{bmatrix}
	1 & \cos(\alpha_1-\alpha_2) & \cos(\alpha_1-\alpha_3) & \dots & \cos(\alpha_1-\alpha_n) \\
	\cos(\alpha_1-\alpha_2) & 1 & \cos(\alpha_2-\alpha_3) & \dots & \cos(\alpha_2-\alpha_n) \\
	\cos(\alpha_1-\alpha_3) & \cos(\alpha_2-\alpha_3) & 1 & \dots & \cos(\alpha_3-\alpha_n) \\
	\vdots & \vdots & \vdots & & \vdots \\
	\cos(\alpha_1-\alpha_n) & \cos(\alpha_2-\alpha_n) & \cos(\alpha_3-\alpha_n) & \dots & 1
\end{bmatrix}.
\]
\begin{solution}
记\(\D = (d_{ij})_n\).
由\cref{equation:函数.三角函数.和积互化公式2} 可知\[
	d_{ij} = \cos(\alpha_i-\alpha_j)
	= \cos\alpha_i\cos\alpha_j+\sin\alpha_i\sin\alpha_j,
	\quad i,j=1,2,\dotsc,n.
\]
记\[
	\A = \begin{bmatrix}
		\cos\alpha_1 & \cos\alpha_2 & \dots & \cos\alpha_n \\
		\sin\alpha_1 & \sin\alpha_2 & \dots & \sin\alpha_n
	\end{bmatrix},
\]那么\(\D = \A^T \A\).

由\cref{theorem:线性方程组.矩阵的秩的性质2} 可知，
\(\rank\A = \rank\A^T \leq \min\{n,2\}\).
由\cref{theorem:线性方程组.矩阵乘积的秩} 可知，\[
	\rank(\A^T\A) \leq \min\left\{\rank\A^T,\rank\A\right\} = \rank\A.
\]

当\(n=1\)时，\(\abs{\D}=1\).

当\(n=2\)时，\[
	\abs{\D}
	= \begin{vmatrix}
		1 & \cos(\alpha_1-\alpha_2) \\
		\cos(\alpha_1-\alpha_2) & 1
	\end{vmatrix}
	= 1 - \cos^2(\alpha_1-\alpha_2).
\]

当\(n>2\)时，
\(\rank(\A^T\A) \leq \rank\A \leq2\)，
\(\D = \A^T \A\)不满秩，
故由\cref{theorem:向量空间.满秩方阵的行列式非零} 有\(\abs{\D}=0\).
\end{solution}
\end{example}

\begin{example}
设\(\a_1=(1,2,-1,0)^T,\a_2=(1,1,0,2)^T,\a_3=(2,1,1,a)^T\).
若\(\dim\opair{\AutoTuple{\a}{3}}=2\)，求\(a\).
\begin{solution}
除了利用\cref{equation:线性方程组.子空间的维数与向量组的秩的联系} 在将矩阵\[
	\A = (\a_1,\a_2,\a_3)
	= \begin{bmatrix}
		1 & 1 & 2 \\
		2 & 1 & 1 \\
		-1 & 0 & 1 \\
		0 & 2 & a
	\end{bmatrix}
\]化为阶梯形矩阵以后，
根据\(\rank\{\AutoTuple{\a}{3}\}=2\)求出\(a\)的值这种方法以外，
我们还可以利用本节\hyperref[definition:线性方程组.矩阵的秩的定义]{矩阵的秩的定义}，
得出\(\rank\A=\dim\opair{\AutoTuple{\a}{3}}=2\)这一结论，
从而根据\cref{definition:线性方程组.矩阵的秩的定义} 可知，
\(\A\)中任意3阶子式全都为零.
对于\(\A\)这么一个\(4\times3\)矩阵，
任意去掉不含\(a\)的一行（不妨去掉第一行）得到一个行列式必为零：\[
	\begin{vmatrix}
	2 & 1 & 1 \\
	-1 & 0 & 1 \\
	0 & 2 & a
	\end{vmatrix}
	= a - 6 = 0,
\]
解得\(a = 6\).
\end{solution}
\end{example}

\begin{example}
%@see: 《高等代数（第三版 上册）》（丘维声） P122 命题2
设\(\A \in M_{m \times n}(\mathbb{R})\).
求证：\begin{equation}
	\rank\A = \rank(\A\A^T).
\end{equation}
\begin{proof}
设\(\rank\A=r\)，
由\hyperref[definition:线性方程组.矩阵的秩的定义]{矩阵的秩的定义}可知，
\(\A\)有\(r\)阶子式不等于零，即\[
	\MatrixMinor\A{
		\AutoTuple{i}{r} \\
		\AutoTuple{j}{r}
	} \neq 0.
	\eqno(1)
\]
由\hyperref[equation:线性方程组.柯西比内公式]{柯西--比内公式}可知
\begin{align*}
	\MatrixMinor{(\A\A^T)}{
		\AutoTuple{i}{r} \\
		\AutoTuple{i}{r}
	}
	&= \sum_{1 \leq k_1 < k_2 < \dotsb < k_r \leq n}
	\MatrixMinor\A{
		\AutoTuple{i}{r} \\
		\AutoTuple{k}{r}
	}
	\MatrixMinor{\A^T}{
		\AutoTuple{k}{r} \\
		\AutoTuple{i}{r}
	} \\
	&= \sum_{1 \leq k_1 < k_2 < \dotsb < k_r \leq n}
	\left[
		\MatrixMinor\A{
			\AutoTuple{i}{r} \\
			\AutoTuple{k}{r}
		}
	\right]^2.
	\tag2
\end{align*}
因为\(\A \in M_{m \times n}(\mathbb{R})\)，
所以\(\A\)的任意子式都是实数，于是有
\[
	\left[
		\MatrixMinor\A{
			\AutoTuple{i}{r} \\
			\AutoTuple{k}{r}
		}
	\right]^2
	\geq 0.
	\eqno(3)
\]
由(1)式可知，
\[
	\left[
		\MatrixMinor\A{
			\AutoTuple{i}{r} \\
			\AutoTuple{j}{r}
		}
	\right]^2
	> 0.
	\eqno(4)
\]
由于在(2)式中，
求和指标可以\((\AutoTuple{k}{r})\)取到\((\AutoTuple{j}{r})\)，
所以(4)式是(2)式中的一项.
综上所述
\[
	\MatrixMinor{(\A\A^T)}{
		\AutoTuple{i}{r} \\
		\AutoTuple{i}{r}
	}
	= \sum_{1 \leq k_1 < k_2 < \dotsb < k_r \leq n}
	\left[
		\MatrixMinor\A{
			\AutoTuple{i}{r} \\
			\AutoTuple{k}{r}
		}
	\right]^2
	> 0,
\]
这就说明\(\rank(\A\A^T) \geq r\).
又因为\(\rank(\A\A^T) \leq \rank\A = r\)，
所以\(\rank(\A\A^T) = \rank\A = r\).
\end{proof}
\end{example}
