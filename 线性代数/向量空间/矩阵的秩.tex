\section{矩阵的秩}
\subsection{矩阵的行秩与列秩}
为了求解向量组的秩，我们可以把向量组看成矩阵的行向量组或列向量组，
利用矩阵的性质，得出这个矩阵的行向量组、列向量组的秩，
最后得到所求向量组的秩.

\begin{definition}\label{definition:线性方程组.行秩与列秩的定义}
%@see: 《线性代数》（张慎语、周厚隆） P76 定义11(1)
设\(\A\)是矩阵.
\begin{enumerate}
	\item \(\A\)的行向量组生成的子空间称为
	“\(\A\)的\DefineConcept{行空间}（row space）”，记为\(\Span_R\A\).
	\item \(\A\)的列向量组生成的子空间称为
	“\(\A\)的\DefineConcept{列空间}（column space）”，记为\(\Span_C\A\).
	\item \(\A\)的行向量组的秩称为
	“\(\A\)的\DefineConcept{行秩}（row rank）”，记为\(\rank_R\A\).
	\item \(\A\)的列向量组的秩称为
	“\(\A\)的\DefineConcept{列秩}（column rank）”，记为\(\rank_C\A\).
\end{enumerate}
%@see: https://mathworld.wolfram.com/RowSpace.html
%@see: https://mathworld.wolfram.com/ColumnSpace.html
\end{definition}

矩阵的列秩等于它的列空间的维数，它的行秩等于它的行空间的维数，即\[
	\rank_C\A=\dim(\Span_C\A), \qquad
	\rank_R\A=\dim(\Span_R\A).
\]

\begin{proposition}\label{theorem:向量空间.矩阵的行秩与列秩分别等于它的转置矩阵的列秩与行秩}
设\(\A\)是矩阵，那么\begin{gather}
	\rank_R\A=\rank_C\A^T, \\
	\rank_C\A=\rank_R\A^T.
\end{gather}
\begin{proof}
显然\(\A\)的行向量组就是\(\A^T\)的列向量组，
而\(\A\)的列向量组就是\(\A^T\)的行向量组.
\end{proof}
\end{proposition}

\begin{definition}
设矩阵\(\A \in M_{s \times n}(K)\).
\begin{enumerate}
	\item 若\(\rank_R\A = s\)，
	则称“\(\A\)为\DefineConcept{行满秩矩阵}（row full rank matrix）”.
	\item 若\(\rank_C\A = n\)，
	则称“\(\A\)为\DefineConcept{列满秩矩阵}（column full rank matrix）”.
\end{enumerate}
\end{definition}

现在我们来研究一个问题：矩阵的列秩与行秩之间有什么联系？

\subsection{矩阵的秩}
\begin{definition}\label{definition:线性方程组.矩阵的秩的定义}
%@see: 《线性代数》（张慎语、周厚隆） P76 定义11(2)
矩阵\(\A\)的非零子式的最高阶数，
称为“矩阵\(\A\)的\DefineConcept{秩}（rank）”，
记为\(\rank\A\).
%@see: https://mathworld.wolfram.com/MatrixRank.html
\end{definition}

\begin{property}\label{theorem:线性方程组.矩阵的秩的性质1}
零矩阵的秩为零，即\(\rank\z = 0\).
\end{property}
\begin{remark}
易证：秩为零的矩阵必为零矩阵.
\end{remark}

\begin{property}\label{theorem:线性方程组.矩阵的秩的性质2}
设\(\A\)是\(s \times n\)矩阵，则\(0 \leq \rank\A \leq \min\{s,n\}\).
\end{property}

\begin{theorem}
设\(\A\in M_{s \times n}(K)\).
如果\(\A\)有一个\(k\)阶非零子式，那么\(\rank\A\geq k\).
\begin{proof}
用反证法.
假设\(\rank\A<k\)，
也就是说\(\A\)的非零子式的最高阶数\(r\)小于\(k\)，
但是根据前提条件，\(\A\)有一个\(k\)阶非零子式，\(k>r\)，
这就和\hyperref[definition:线性方程组.矩阵的秩的定义]{矩阵的秩的定义}矛盾！
因此\(\rank\A\geq k\).
\end{proof}
\end{theorem}

\begin{example}
求矩阵\(\A = \begin{bmatrix} 1 & 7 \\ 2 & 6 \\ -3 & 1 \end{bmatrix}\)的秩、行秩与列秩.
\begin{solution}
因为至少存在一个\(\A\)的二阶子式不为零，即\[
	\begin{vmatrix} 1 & 7 \\ 2 & 6 \end{vmatrix} = -8 \neq 0,
\]
且\(\A\)没有三阶子式，所以\(\rank\A = 2\).

写出\(\A\)的行向量组\[
	(1,7), \qquad
	(2,6), \qquad
	(-3,1),
\]
分别转置后，列成一个矩阵（显然就是\(\A^T\)），
作初等行变换化成阶梯形矩阵\[
	\A^T = \begin{bmatrix}
		1 & 2 & -3 \\
		7 & 6 & 1
	\end{bmatrix} \to \begin{bmatrix}
		1 & 0 & 17/2 \\
		0 & 4 & -11
	\end{bmatrix} = \B_1.
\]阶梯形矩阵\(\B_1\)有2行不为零，故矩阵\(\A\)的行秩为2.

写出\(\A\)的列向量组\[
	(1,2,-3)^T,
	(7,6,1)^T,
\]列成一个矩阵（显然就是\(\A\)本身），
作初等行变换化成阶梯形矩阵\[
	\A = \begin{bmatrix} 1 & 7 \\ 2 & 6 \\ -3 & 1 \end{bmatrix}
	\to \begin{bmatrix} 1 & 0 \\ 0 & 1 \\ 0 & 0 \end{bmatrix} = \B_2.
\]
阶梯形矩阵\(\B_2\)有2行不为零，故矩阵\(\A\)的列秩为2.
\end{solution}
\end{example}

\subsection{矩阵的秩、行秩、列秩的关系}
\begin{lemma}\label{theorem:向量空间.矩阵的秩与行秩和列秩的关系.引理}
%@see: 《线性代数》（张慎语、周厚隆） P77 引理
设矩阵\(\A = (a_{ij})_{s \times n}\)的列秩等于\(\A\)的列数\(n\)，
则\(\A\)行秩、秩都等于\(n\).
\begin{proof}
对\(\A\)分别进行列分块与行分块：\[
	\A = (\AutoTuple{\a}{n})
	= (\AutoTuple{\A}{s}[,][T])^T.
\]
根据\cref{theorem:向量空间.秩与线性相关性的关系}，
由于\(\rank_C\A=n\)，
所以\(\A\)的列向量组线性无关，
也就是说齐次线性方程组\[
	x_1 \a_1 + x_2 \a_2 + \dotsb + x_n \a_n = \z
\]只有零解，或者说\(\A\x=\z\)只有零解.
进而根据\cref{theorem:线性方程组.方程个数少于未知量个数的齐次线性方程组必有非零解}，
在\(\A\x=\z\)中，方程个数\(s\)不少于未知量个数\(n\)，即\(s \geq n\).

设\(\rank_R\A=t\).
根据\cref{theorem:向量空间.子空间维数.命题4}，
因为\(\A\)的行向量的维数是\(n\)，
所以\(t \leq n\).

设\(\A\)的行极大线性无关组是
\(\A_{i_1},\A_{i_2},\dotsc,\A_{i_t}\)，
其中\(1 \leq i_1 < i_2 < \dotsb < i_t \leq s\).

假设\(t < n\)，
则\(\A\)可通过初等行变换化为\[
	\begin{bmatrix}
		\A_{i_1} \\ \A_{i_2} \\ \vdots \\ \A_{i_t} \\ \z_{(s-t) \times n}
	\end{bmatrix},
\]
于是，\(\A\x=\z\)表示的齐次线性方程组中，
非零方程的个数\(t\)小于未知量个数\(n\)，
那么根据\cref{theorem:线性方程组.方程个数少于未知量个数的齐次线性方程组必有非零解}，
\(\A\x=\z\)有非零解，
这与我们前面得到的结论“\(\A\x=\z\)只有零解”矛盾，
所以假设\(t < n\)不成立，
因此\(t = n\).
这就是说\[
	\rank_R\A=\rank_C\A=n.
\]

既然\(t=n\)，
那么\(\A\)的行极大线性无关组恰好可以构成一个方阵，
而这个方阵的行列式为\[
	d=\begin{vmatrix} \A_{i_1} \\ \A_{i_2} \\ \vdots \\ \A_{i_n} \end{vmatrix}.
\]
根据\cref{theorem:线性方程组.克拉默法则}，
因为\(\A\x=\z\)只有零解作为它的唯一解，
所以\(d\neq0\).
于是\(d\)是\(\A\)的一个\(n\)阶非零子式.
\(\A\)是一个\(s \times n\)矩阵，
不可能有阶数大于\(n\)的子式，
因此\(\rank\A = n\).
\end{proof}
\end{lemma}

\begin{theorem}\label{theorem:向量空间.矩阵的秩与行秩和列秩的关系.定理}
%@see: 《线性代数》（张慎语、周厚隆） P77 定理5
矩阵的行秩、列秩、秩都相等.
\begin{proof}
如果矩阵\(\A = \z\)，
则\(\rank\A=\rank_R\A=\rank_C\A=0\)，
结论成立.

当\(\A\neq\z\)时，
设\(\rank\A=r\)，
则根据\hyperref[definition:线性方程组.矩阵的秩的定义]{矩阵的秩的定义}，
\(\A\)的所有\(t\ (t > r)\)阶子式全为零；
且\(\A\)有一个\(r\)阶子式不为零，
从而该\(r\)阶子式的列向量组线性无关，
它们的延伸组也线性无关，
\(\A\)有\(r\)列线性无关，
于是\(\rank_C\A=p \geq r\)；
由\cref{theorem:向量空间.矩阵的秩与行秩和列秩的关系.引理}，
\(\A\)的列极大线性无关组构成的矩阵有一非零\(p\)阶子式，
也是\(\A\)的子式，
故\(p \leq r\)；
综上得\(p = r\).
因此\(\rank\A=\rank_C\A\).
同样地，将这一结论用于\(\A^T\)，
得\(\rank\A^T=\rank_C\A^T=\rank_R\A\).
\end{proof}
\end{theorem}

\begin{theorem}
%@see: 《高等代数（第三版 上册）》（丘维声） P83 推论6
设\(\A\)是矩阵，那么\(\rank\A = \rank\A^T\).
\begin{proof}
根据\cref{theorem:向量空间.矩阵的秩与行秩和列秩的关系.定理,theorem:向量空间.矩阵的行秩与列秩分别等于它的转置矩阵的列秩与行秩}，
有\(\rank\A=\rank_C\A=\rank_R\A^T=\rank\A^T\).
\end{proof}
\end{theorem}

\subsection{初等变换对矩阵的秩的影响}
\begin{theorem}\label{theorem:线性方程组.初等变换不变秩}
%@see: 《高等代数（第三版 上册）》（丘维声） P81 定理2
%@see: 《高等代数（第三版 上册）》（丘维声） P82 定理3
%@see: 《高等代数（第三版 上册）》（丘维声） P83 推论7
初等变换不改变矩阵的秩.
\begin{proof}
由\cref{theorem:向量空间.利用初等行变换求取列极大线性无关组的依据}，
初等行变换不改变矩阵的列秩；
同理，初等列变换不改变矩阵的行秩；
再由\cref{theorem:向量空间.矩阵的秩与行秩和列秩的关系.定理}，
初等变换不改变矩阵的秩.
\end{proof}
\end{theorem}

\begin{example}
%@see: 《高等代数（第三版 上册）》（丘维声） P86 习题3.5 12.
%@see: 《高等代数学习指导书（第二版 上册）》（丘维声） P115 例8
设\(\A \in M_{s \times n}(K),
\B \in M_{l \times m}(K)\).
试证：\begin{equation}
	\rank\begin{bmatrix}
		\A & \z \\
		\z & \B
	\end{bmatrix}
	= \rank\A + \rank\B.
	\label{equation:矩阵的秩.分块矩阵的秩的等式1}
\end{equation}
\begin{proof}
\def\J{\vb{J}}
若\(\A\)或\(\B\)是零矩阵，
则必有\(\rank\A=0\)或\(\rank\B=0\)，
这时候\cref{equation:矩阵的秩.分块矩阵的秩的等式1} 显然成立.
下面我们假设\(\A\)和\(\B\)的秩都大于零，
对矩阵\(\begin{bmatrix}
	\A & \z \\
	\z & \B
\end{bmatrix}\)的前\(s\)行、后\(l\)行分别作初等行变换，化成\[
	\begin{bmatrix}
		\J_r & \z \\
		\z & \z \\
		\z & \J_t \\
		\z & \z
	\end{bmatrix},
	\eqno(1)
\]
其中\(\J_r\)是\(r \times n\)阶的阶梯形矩阵，且\(r\)行都是非零行，\(\rank\A=r\)；
\(\J_t\)是\(t \times m\)阶的阶梯形矩阵，且\(t\)行都是非零行，\(\rank\B=t\).
对矩阵(1)作一系列的两行互换，化成\[
	\begin{bmatrix}
		\J_r & \z \\
		\z & \J_t \\
		\z & \z
	\end{bmatrix},
	\eqno(2)
\]
矩阵(2)是阶梯形矩阵，它有\(r+t\)个非零行.
因此\[
	\rank\begin{bmatrix}
		\A & \z \\
		\z & \B
	\end{bmatrix}
	= r+t
	= \rank\A+\rank\B.
	\qedhere
\]
\end{proof}
\end{example}

\subsection{满秩矩阵}
\begin{definition}
%@see: 《线性代数》（张慎语、周厚隆） P76
设矩阵\(\A \in M_n(K)\).
若\(\rank\A = n\)，
则称“\(\A\)是\DefineConcept{满秩矩阵}（full rank matrix）”，
或“\(\A\)是\DefineConcept{非退化矩阵}（non-degenerate matrix）”.
\end{definition}

%应该注意到，“可逆矩阵”“非奇异矩阵”“满秩矩阵”“非退化矩阵”是从不同侧重点对同一类矩阵的四种称谓.

\begin{theorem}\label{theorem:向量空间.满秩方阵的行列式非零}
%@see: 《高等代数（第三版 上册）》（丘维声） P84 推论9
设\(\A\in M_n(K)\).
\(\A\)是满秩矩阵的充分必要条件是\(\abs{\A}\neq0\).
\begin{proof}
\(\rank\A=n
\iff \text{\(A\)的非零子式的最高阶数为\(n\)}
\iff \abs{\A}\neq0\).
\end{proof}
\end{theorem}

\begin{corollary}
%@see: 《高等代数（第三版 上册）》（丘维声） P84 推论10
设\(\A\in M_{s \times n}(K)\)且\(\rank\A=r\).
那么，\(\A\)的\(r\)阶非零子式
所在的列构成\(\A\)的列向量组的一个极大线性无关组，
所在的行构成\(\A\)的行向量组的一个极大线性无关组.
\end{corollary}

现在我们来对\cref{equation:矩阵的秩.分块矩阵的秩的等式1} 做一番推广，
我们用一个非零矩阵\(\C\)取代分块对角矩阵\(\begin{bmatrix}
	\A & \z \\
	\z & \B
\end{bmatrix}\)的一个副对角，
得到分块上三角矩阵\(\begin{bmatrix}
	\A & \C \\
	\z & \B
\end{bmatrix}\)或分块下三角矩阵\(\begin{bmatrix}
	\A & \z \\
	\C & \B
\end{bmatrix}\)，
接下来我们研究这类矩阵的秩的取值范围.
\begin{example}
%@see: 《高等代数（第三版 上册）》（丘维声） P87 习题3.5 13.
%@see: 《高等代数学习指导书（第二版 上册）》（丘维声） P116 例9
设\(\A \in M_{s \times n}(K),
\B \in M_{l \times m}(K),
\C \in M_{s \times m}(K)\).
试证：\begin{equation}
	\rank\begin{bmatrix}
		\A & \C \\
		\z & \B
	\end{bmatrix} \geq \rank\A + \rank\B,
	\label{equation:矩阵的秩.分块矩阵的秩的不等式}
\end{equation}
\begin{proof}
设\(\rank\A=r,
\rank\B=t\).
那么\(\A\)有一个\(r\)阶子矩阵\(\A_1\)，
使得\(\abs{\A_1}\neq0\)；
\(\B\)有一个\(t\)阶子矩阵\(\B_1\)，
使得\(\abs{\B_1}\neq0\).
从而\(\begin{bmatrix}
	\A & \C \\
	\z & \B
\end{bmatrix}\)有一个\(r+t\)阶子式：\[
	\begin{vmatrix}
		\A_1 & \C_1 \\
		\z & \B_1
	\end{vmatrix}
	= \abs{\A_1} \abs{\B_1}
	\neq 0.
\]
因此\[
	\rank\begin{bmatrix}
		\A & \C \\
		\z & \B
	\end{bmatrix}
	\geq r+t
	= \rank\A+\rank\B.
\]
当\(\A\)或\(\B\)满秩时，上式取“\(=\)”.
\end{proof}
\end{example}
