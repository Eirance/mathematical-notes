\section{二次型的基本概念}
我们首先研究平面解析几何中以坐标原点为中心的二次曲线的方程：
\begin{center}
	\def\arraystretch{1.5}
	\begin{tblr}{cl}
		圆 & \(x^2+y^2=r^2\) \\
		椭圆 & \(\frac{x^2}{a^2}+\frac{y^2}{b^2}=1\) \\
		双曲线 & \(\frac{x^2}{a^2}-\frac{y^2}{b^2}=1\) \\
	\end{tblr}
\end{center}

可以看出，它们都具有\[
	a x^2 + 2b xy + c y^2 = d
\]的形式.
在研究二次曲线时，如果得到的方程不是标准方程，
我们通常希望通过旋转、平移等几何变换将其化为标准方程，
进而判别曲线的形状和几何性质.

\subsection{二次型的基本概念}
\begin{definition}
%@see: 《高等代数（第三版 上册）》（丘维声） P192 定义1
系数在数域\(K\)中的\(n\)个变量的
二次齐次多项式\begin{equation}\label{equation:二次型.二次型}
	f(\AutoTuple{x}{n})
	= \sum_{i=1}^n \sum_{j=1}^n a_{ij} x_i x_j
	\quad(a_{ji}=a_{ij},i,j=1,2,\dotsc,n),
\end{equation}
称为“数域\(K\)上的一个\(n\)元\DefineConcept{二次型}（quadratic form）”.
%@see: https://mathworld.wolfram.com/QuadraticForm.html
%@see: https://mathworld.wolfram.com/DiagonalQuadraticForm.html
%@see: https://mathworld.wolfram.com/SymmetricBilinearForm.html
\end{definition}

数域对于一个二次齐次多项式是否成为二次型是决定性的.
多项式\[
	f(x_1,x_2,x_3) = x_1^2 + 4 x_1 x_2 + 3 x_2^2 + 5 x_2 x_3 - x_3^2
\]和\[
	g(x_1,x_2,x_3) = x_1^2 + 2\sqrt{2} x_1 x_2 + 2 x_1 x_3 + 2 x_2^2 + 4\sqrt{3} x_2 x_3
\]都是实数域上的二次型；
但在有理数域上，只有\(f\)是二次型，\(g\)不是二次型.

本章不作特别声明时，所称“二次型”均指实二次型.

前面提到我们希望将一般方程化为标准方程，现在我们就要定义何种形式的方程应该被称为标准方程.
再次观察平面二次曲线的标准方程可以发现，标准方程的等号左边应该是二次齐次多项式（即若干个变量的平方和），等号右边则应该是任意（非零）常数.

\begin{definition}
若数域\(K\)上的\(n\)阶对称矩阵\(\A\)
满足\begin{equation}\label{equation:二次型.二次型的矩阵表示}
	f(\AutoTuple{x}{n}) = \x^T\A\x,
\end{equation}
其中\(\x = (\AutoTuple{x}{n})^T\)，
则把\cref{equation:二次型.二次型的矩阵表示}
称为“二次型\(f(\AutoTuple{x}{n})\)的\DefineConcept{矩阵表示}”，
把\(\A\)称为\(f\)的\DefineConcept{矩阵}，
把\(\A\)的秩\(\rank\A\)称为\(f\)的\DefineConcept{秩}.
\end{definition}

显然，对于任一\(n\)阶矩阵\(\B\)，\(\x^T\B\x\)必定是一个二次型.
需要注意的是，矩阵\(\B\)不必是对称矩阵，但“二次型\(\x^T\B\x\)的矩阵”必定是一个对称矩阵.

\begin{property}
二次型和它的矩阵是相互唯一确定的.
\begin{proof}
对于二次型\(f(\AutoTuple{x}{n})\)，
设非零\(n\)阶对称矩阵\(\A\)和\(\B\)都是\(f\)的矩阵，
即\[
	\x^T\A\x
	=\x^T\B\x
	=f(\AutoTuple{x}{n}),
\]
则二次型\(\x^T\A\x\)与\(\x^T\B\x\)中\(x_i x_j\)的
系数\(2 a_{ij}\)与\(2 b_{ij}\ (1 \leq i < j \leq n)\)必相等，
\(x_i^2\)的系数\(a_{ii}\)与\(b_{ii}\ (i=1,2,\dotsc,n)\)必相等，
故\(\A=\B\).
\end{proof}
\end{property}

\begin{example}
将\(f(x_1,x_2,x_3) = x_1^2 + 4 x_1 x_2 + 3 x_2^2 + 5 x_2 x_3 - x_3^2\)写成矩阵形式.
\begin{solution}
\(f(x_1,x_2,x_3)
= \begin{bmatrix}
	x_1 & x_2 & x_3
\end{bmatrix}
\begin{bmatrix}
	1 & 2 & 0 \\
	2 & 3 & \frac{5}{2} \\
	0 & \frac{5}{2} & -1
\end{bmatrix}
\begin{bmatrix}
	x_1 \\ x_2 \\ x_3
\end{bmatrix}\).
\end{solution}
\end{example}

\begin{example}
写出二次型\(\begin{bmatrix}
	x_1 & x_2 & x_3
\end{bmatrix}
\begin{bmatrix}
	2 & -3 & 1 \\
	1 & 0 & 1 \\
	2 & 11 & 3
\end{bmatrix}
\begin{bmatrix}
	x_1 \\ x_2 \\ x_3
\end{bmatrix}\)的矩阵.
\begin{solution}
注意到矩阵\(\A = \begin{bmatrix}
	2 & -3 & 1 \\
	1 & 0 & 1 \\
	2 & 11 & 3
\end{bmatrix}\)不是对称矩阵，
二次型\(\x^T\A\x\)的矩阵应为\[
	\B
	= \frac{\A+\A^T}{2}
	= \begin{bmatrix}
		2 & -1 & \frac{3}{2} \\
		-1 & 0 & 6 \\
		\frac{3}{2} & 6 & 3
	\end{bmatrix}.
\]
\end{solution}
\end{example}

\begin{example}\label{example:二次型.反对称矩阵对应的二次型恒为零}
%@see: 《高等代数（第三版 上册）》（丘维声） P202 习题6.1 5.
设\(\A\)是数域\(K\)上的\(n\)阶矩阵.
证明：\(\A\)是反对称矩阵的充分必要条件是
“对于\(K^n\)中任一列向量\(\vb\alpha\)，
有\(\vb\alpha^T \A \vb\alpha = 0\)”.
\begin{proof}
假设\(\A\)是反对称矩阵，
即\(\A^T = -\A\)，
那么对于\(K^n\)中任一列向量\(\vb\alpha\)，
有\[
	\vb\alpha^T \A \vb\alpha
	= - \vb\alpha^T \A^T \vb\alpha
	= - (\vb\alpha^T \A \vb\alpha)^T
	= - \vb\alpha^T \A \vb\alpha, % \(\vb\alpha^T \A \vb\alpha\)是一个数，数的转置还是这个数
\]
于是\(\vb\alpha^T \A \vb\alpha = 0\).

假设对于\(K^n\)中任一列向量\(\vb\alpha\)，
有\(\vb\alpha^T \A \vb\alpha = 0\)，
那么\[
	0 = \vb\alpha^T \A \vb\alpha
	= (\vb\alpha^T \A \vb\alpha)^T
	= \vb\alpha^T \A^T \vb\alpha
	= - (\vb\alpha^T \A \vb\alpha),
\]
从而有\[
	\vb\alpha^T \A^T \vb\alpha
	+ \vb\alpha^T \A \vb\alpha
	= \vb\alpha^T (\A^T + \A) \vb\alpha
	= 0,
\]
于是\(\A + \A^T = 0\)，
\(\A\)是反对称矩阵.
\end{proof}
\end{example}
\begin{example}
%@see: 《高等代数（第三版 上册）》（丘维声） P202 习题6.1 6.
设\(\A\)是数域\(K\)上的\(n\)阶对称矩阵.
证明：如果对于\(K^n\)中任一列向量\(\vb\alpha\)，
都有\(\vb\alpha^T \A \vb\alpha = 0\)，
则\(\A = \vb0\).
\begin{proof}
由于对于\(K^n\)中任一列向量\(\vb\alpha\)，
都有\[
	\vb\alpha^T \A \vb\alpha = \vb\alpha^T (0\E) \vb\alpha,
\]
其中\(\E\)是数域\(K\)上的\(n\)阶单位矩阵，
所以\[
	\vb\alpha^T \A \vb\alpha - \vb\alpha^T (0\E) \vb\alpha
	= \vb\alpha^T (\A - \vb0) \vb\alpha
	= 0,
\]
于是\(\A = \vb0\).
\end{proof}
\end{example}
\begin{example}
%@see: 《高等代数（第三版 上册）》（丘维声） P202 习题6.1 7.
证明：秩为\(r\)的对称矩阵可以表示成\(r\)个秩为\(1\)的对称矩阵之和.
%TODO proof
\end{example}
\begin{example}
%@see: 《高等代数（第三版 上册）》（丘维声） P202 习题6.1 9.
证明：数域\(K\)上的反对称矩阵一定合同于下述形式的分块对角矩阵：\[
	\diag\left(
		\begin{bmatrix}
			0 & 1 \\
			-1 & 0
		\end{bmatrix},
		\dotsc,
		\begin{bmatrix}
			0 & 1 \\
			-1 & 0
		\end{bmatrix},
		0,\dotsc,0
	\right).
\]
%TODO proof
\end{example}
\begin{example}
%@see: 《高等代数（第三版 上册）》（丘维声） P202 习题6.1 10.
证明：反对称矩阵的秩一定是偶数.
%TODO proof
\end{example}
\begin{example}\label{example:二次型.瑞利商的取值范围}
%@see: 《高等代数（第三版 上册）》（丘维声） P202 习题6.1 11.
设\(n\)阶实对称矩阵\(\A\)的全部特征值按大小顺序排成
\(\lambda_1 \geq \lambda_2 \geq \dotsb \geq \lambda_n\).
证明：对于\(\mathbb{R}^n\)中任一非零列向量\(\vb\alpha\)，
都有\begin{equation*}
	\lambda_n \leq \frac{\vb\alpha^T \A \vb\alpha}{\vb\alpha^T \vb\alpha} \leq \lambda_1.
\end{equation*}
\begin{proof}
假设正交矩阵\(\Q\)满足\begin{equation*}
	\Q^T \A \Q = \vb\Lambda,
\end{equation*}
其中\(\vb\Lambda = \diag(\AutoTuple{\lambda}{n})\)，
那么\begin{equation*}
	\vb\alpha^T \A \vb\alpha
	= \vb\alpha^T (\Q \vb\Lambda \Q^T) \vb\alpha
	= (\Q^T \vb\alpha)^T \vb\Lambda (\Q^T \vb\alpha)
	= \lambda_1 b_1^2 + \dotsb + \lambda_n b_n^2,
\end{equation*}
其中\(\Q^T \vb\alpha = (\AutoTuple{b}{n})\).
因为\(\lambda_1 \geq \lambda_2 \geq \dotsb \geq \lambda_n\)，
所以\begin{gather*}
	\lambda_1 b_1^2 + \dotsb + \lambda_n b_n^2
	\geq \lambda_n b_1^2 + \dotsb + \lambda_n b_n^2
	= \lambda_n (b_1^2 + \dotsb + b_n^2), \\
	\lambda_1 b_1^2 + \dotsb + \lambda_n b_n^2
	\leq \lambda_1 b_1^2 + \dotsb + \lambda_1 b_n^2
	= \lambda_1 (b_1^2 + \dotsb + b_n^2),
\end{gather*}
又由于\begin{equation*}
	b_1^2 + \dotsb + b_n^2
	= (\Q^T \vb\alpha)^T (\Q^T \vb\alpha)
	= \vb\alpha^T (\Q \Q^T) \vb\alpha
	= \vb\alpha^T \vb\alpha
	\neq 0,
\end{equation*}
所以\(\lambda_n \vb\alpha^T \vb\alpha
\leq \vb\alpha^T \A \vb\alpha
\leq \lambda_1 \vb\alpha^T \vb\alpha\).
\end{proof}
\end{example}
\begin{example}
%@see: 《高等代数（第三版 上册）》（丘维声） P202 习题6.1 12.
设\(\A\)是一个\(n\)阶实对称矩阵.
证明：存在一个正实数\(c\)，使得对于\(\mathbb{R}^n\)中任一列向量\(\vb\alpha\)，
都有\(\abs{\vb\alpha^T \A \vb\alpha} \leq c \vb\alpha^T \vb\alpha\).
\begin{proof}
由\cref{example:二次型.瑞利商的取值范围} 可知，
如果\(\A\)的最大特征值是\(\lambda_1\)，最小特征值是\(\lambda_n\)，
那么\begin{equation*}
	\lambda_n \vb\alpha^T \vb\alpha
	\leq \vb\alpha^T \A \vb\alpha
	\leq \lambda_1 \vb\alpha^T \vb\alpha,
\end{equation*}
从而有\begin{gather*}
	\abs{\vb\alpha^T \A \vb\alpha}
	\leq \abs{\lambda_1 \vb\alpha^T \vb\alpha}
	= \abs{\lambda_1} \vb\alpha^T \vb\alpha, \\
	\abs{\vb\alpha^T \A \vb\alpha}
	\leq \abs{\lambda_n \vb\alpha^T \vb\alpha}
	= \abs{\lambda_n} \vb\alpha^T \vb\alpha,
\end{gather*}
因此只要取\(c = \max\{\abs{\lambda_1},\abs{\lambda_n}\}\)即可.
\end{proof}
\end{example}
\begin{example}
%@see: 《高等代数（第三版 上册）》（丘维声） P202 习题6.1 13.
设\(\A,\B\)都是\(n\)阶实对称矩阵，并且\(\A\B=\B\A\).
证明：存在一个\(n\)阶正交矩阵\(\Q\)，
使得\(\Q^T \A \Q\)与\(\Q^T \B \Q\)都是对角矩阵.
%TODO proof
\end{example}
\begin{example}
%@see: 《高等代数（第三版 上册）》（丘维声） P202 习题6.1 14.
设\(n\)元实二次型\(\vb{x}^T \A \vb{x}\)的矩阵\(\A\)的一个特征值是\(\lambda_i\).
证明：存在\(\mathbb{R}^n\)中非零列向量\(\vb\alpha\)使得\[
	\vb\alpha^T \A \vb\alpha = \lambda_i \vb\alpha^T \vb\alpha.
\]
%TODO proof
\end{example}

\subsection{线性替换}
\begin{definition}
因为平面二次曲线方程通过旋转变换化为标准方程，
实际上是用新变量的一次式代替原来的变量.
同样地，使用这种基本的方法来化简一般的\(n\)元二次型，
作如下的变量替换：\[
	\left\{ \begin{array}{l}
		x_1 = c_{11}y_1 + c_{12}y_2 + \dotsb + c_{1n}y_n \\
		x_2 = c_{21}y_1 + c_{22}y_2 + \dotsb + c_{2n}y_n \\
		\hdotsfor{1} \\
		x_n = c_{n1}y_1 + c_{n2}y_2 + \dotsb + c_{nn}y_n
	\end{array} \right.
\]
写成矩阵形式\[
	\begin{bmatrix}
		x_1 \\ x_2 \\ \vdots \\ x_n
	\end{bmatrix}
	= \begin{bmatrix}
		c_{11} & c_{12} & \dots & c_{1n} \\
		c_{21} & c_{22} & \dots & c_{2n} \\
		\vdots & \vdots & & \vdots \\
		c_{n1} & c_{n2} & \dots & c_{nn}
	\end{bmatrix}
	\begin{bmatrix}
		y_1 \\ y_2 \\ \vdots \\ y_n
	\end{bmatrix}
	\quad\text{或}\quad
	\x=\C\y.
\]

上述变量之间的替换称为\DefineConcept{线性替换}.

当矩阵\(\C\)可逆时，
称之为\DefineConcept{可逆线性替换}、\DefineConcept{满秩线性替换}或\DefineConcept{非退化线性替换}.

当矩阵\(\C\)是正交矩阵时，
称之为\DefineConcept{正交线性替换}.
\end{definition}

\begin{theorem}
对二次型\(f(\AutoTuple{x}{n})=\x^T\A\x\ (\A=\A^T)\)作可逆线性替换\(\x=\C\y\)，则\(f\)化为新变量的二次型\(g(\AutoTuple{y}{n})=\y^T\B\y\)，其中\(\B=\C^T\A\C\)为\(g\)的矩阵.
\begin{proof}
\(f(\AutoTuple{x}{n}) = \x^T\A\x%
\xlongequal{\x=\C\y} (\C\y)^T\A(\C\y)%
= \y^T (\C^T\A\C) \y\)，
令\(\B = \C^T\A\C\)，由于\(\B^T = (\C^T\A\C)^T = \C^T\A\C = \B\)，以及\(\C\)可逆，所以\(\B\)是对称矩阵.
\(f\)是二次型，它的矩阵\(\A\neq\z\)，\(\B\cong\A\)，故\(\B\neq\z\).
于是，\(g(\AutoTuple{y}{n})=\y^T\B\y\)是二次型，对称矩阵\(\B\)是\(g\)的矩阵.
\end{proof}
\end{theorem}
