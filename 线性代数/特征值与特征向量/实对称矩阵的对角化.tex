\section{实对称矩阵的对角化}
由上节讨论我们知道，\(n\)阶矩阵分成可对角化与不可对角化两类.
实际上，矩阵的相似概念与数域有关，矩阵能否对角化也与数域有关.
因为一般矩阵的特征值是复数，即使\(\A\)的元素都是实数，也可能没有实数特征值.
例如，\(\A = \begin{bmatrix} 0 & -1 \\ 1 & 0 \end{bmatrix}\)是一个二阶实矩阵，
由于\[
	\abs{\lambda\E-\A}
	= \begin{vmatrix}
		\lambda & 1 \\
		-1 & \lambda
	\end{vmatrix}
	= (\lambda+\iu)(\lambda-\iu),
\]
可以看出\(\A\)有两个特征值\(\pm\iu\)，
其对应的特征向量\((\iu,1)^T\)和\((\iu,-1)^T\)是复向量，
因此\(\A\)在复数域上可对角化，
但不存在可逆实阵\(\P\)使得\(\P^{-1}\A\P\)为对角阵.

\begin{theorem}\label{theorem:特征值与特征向量.实对称矩阵1}
%@see: 《线性代数》（张慎语、周厚隆） P109 定理6
实对称矩阵的特征值都是实数.
\begin{proof}
设\(\A \in M_n(\mathbb{R})\)满足\(\A^T=\A\).
显然\(\A\)的特征多项式\(\abs{\lambda\E-\A}\)在复数范围内有\(n\)个根.
假设\(\lambda_0\in\mathbb{C}\)是\(\A\)的任意一个特征值，
则存在\(n\)维复向量\(\X0=(\AutoTuple{c}{n})^T \neq \z\)，使得
\begin{gather}
	\A\X0 = \lambda_0 \X0, \tag1
\end{gather}
用\(\X0\)的共轭转置向量\(\overline{\X0}^T
=(\overline{c_1},\overline{c_2},\dotsc,\overline{c_n})\)
左乘(1)式两端，
得\begin{gather}
	\overline{\X0}^T \A \X0 = \lambda \overline{\X0}^T \X0, \tag2
\end{gather}
其中\(\A^T=\A=\overline{\A}\)，
\(\overline{\X0}^T \X0
= \overline{c_1}c_1 + \overline{c_2}c_2 + \dotsb + \overline{c_n}{c_n} \in \mathbb{R}^+\).

又因为\(\overline{\X0}^T \A \X0 \in \mathbb{C}\)取转置不变，
且实对称矩阵满足\(\A^T = \A = \overline{\A}\)，
所以\[
	\overline{\X0}^T \A \X0
	= (\overline{\X0}^T \A \X0)^T
	= \X0^T \A^T \overline{\X0}
	= \overline{\overline{\X0}^T} \overline{\A} \overline{\X0}
	= \overline{\overline{\X0}^T \A \X0},
\]
说明\(\overline{\X0}^T \A \X0 \in \mathbb{R}\)，进而有\(\lambda_0 \in \mathbb{R}\).
\end{proof}
\end{theorem}

\begin{theorem}\label{theorem:特征值与特征向量.实对称矩阵2}
%@see: 《线性代数》（张慎语、周厚隆） P109 定理7
实对称矩阵的不同特征值所对应的特征向量正交.
\begin{proof}
设\(\A\)是实对称矩阵，
\(\lambda_1\neq\lambda_2\)是\(\A\)的两个不同的特征值，
\(\X1\neq\z\)，
\(\X2\neq\z\)分别是\(\A\)对应于\(\lambda_1\)、\(\lambda_2\)的特征向量，
则\(\X1\)、\(\X2\)都是实向量，
\begin{align*}
	\A\X1 &= \lambda_1\X1, \tag1 \\
	\A\X2 &= \lambda_2\X2. \tag2
\end{align*}
对(1)式左乘\(\X2^T\)，得\begin{gather}
	\X2^T \A \X1 = \lambda_1 \X2^T \X1, \tag3
\end{gather}
对(2)式左乘\(\X1^T\)，得\begin{gather}
	\X1^T \A \X2 = \lambda_2 \X1^T \X2, \tag4
\end{gather}
(3)式取转置，
得\(\lambda_1(\X2^T \X1)^T = (\X2^T \A \X1)^T\)，
又由\(\A=\A^T\)，
得\begin{gather}
	\lambda_1 \X1^T \X2 = \X1^T \A^T \X2 = \X1^T \A \X2, \tag5
\end{gather}
(5)式减(4)式，得
\begin{gather}
	(\lambda_2-\lambda_1)\X1^T\X2=0. \tag6
\end{gather}
因为\(\lambda_2 \neq \lambda_1\)，
所以\(\X1^T \X2 = 0\)，
即\((\X1,\X2) = 0\)，
也就是\(\X1\)与\(\X2\)正交.
\end{proof}
\end{theorem}

一般地，对于\(n\)阶实对称矩阵\(\A\)，
属于\(\A\)的同一特征值的一组线性无关的特征向量不一定相互正交，
可用施密特正交化方法将其正交化，得到\(\A\)的属于该特征值的正交特征向量组.
由以上定理，\(\A\)的几个属于不同特征值的正交特征向量组仍构成正交组.
特别地，\(\A\)有\(n\)个正交的特征向量，\(\A\)相似于对角形矩阵.

\begin{example}
%@see: 《1995年全国硕士研究生入学统一考试（数学一）》八解答题
设3阶实对称矩阵\(\vb{A}\)的特征值为
\(\lambda_1=-1,\lambda_2=\lambda_3=1\)，
对应于\(\lambda_1\)的特征向量为\(\vb{\xi}_1=(0,1,1)^T\)，
求\(\vb{A}\).
\begin{solution}
设属于\(\lambda=1\)的特征向量为\(\vb{\xi}=(x_1,x_2,x_3)^T\)，
由于\hyperref[theorem:特征值与特征向量.实对称矩阵2]{实对称矩阵的不同特征值所对应的特征向量相互正交}，
故\[
	\vb{\xi}^T \vb{\xi}_1 = x_2+x_3 = 0,
\]
于是\(\vb{\xi}_2=(1,0,0)^T,
\vb{\xi}_3=(0,1,-1)^T\)
是属于\(\lambda=1\)的线性无关的特征向量，
也就是说\[
	\vb{A}(\vb{\xi}_1,\vb{\xi}_2,\vb{\xi}_3)
	=(-\vb{\xi}_1,\vb{\xi}_2,\vb{\xi}_3).
\]
那么\[
	\vb{A}
	=(-\vb{\xi}_1,\vb{\xi}_2,\vb{\xi}_3)
	(\vb{\xi}_1,\vb{\xi}_2,\vb{\xi}_3)^{-1}
	=\begin{bmatrix}
		0 & 1 & 0 \\
		-1 & 0 & 1 \\
		-1 & 0 & -1
	\end{bmatrix}
	\begin{bmatrix}
		0 & \frac{1}{2} & \frac{1}{2} \\
		1 & 0 & 0 \\
		0 & \frac{1}{2} & -\frac{1}{2}
	\end{bmatrix}
	=\begin{bmatrix}
		1 & 0 & 0 \\
		0 & 0 & -1 \\
		0 & -1 & 0
	\end{bmatrix}.
\]
\end{solution}
\end{example}

\begin{theorem}\label{theorem:特征值与特征向量.实对称矩阵3}
%@see: 《线性代数》（张慎语、周厚隆） P110 定理8
若\(\A\)为\(n\)阶实对称矩阵，则一定存在正交矩阵\(\Q\)，使得\(\V = \Q^{-1}\A\Q\)为对角形矩阵.
\begin{proof}
\def\M{\vb{M}}%
用数学归纳法.
当\(n=1\)时，矩阵\(\A\)是一个实数\(a_{11}\)，定理成立.
假设当\(n=k-1\)时定理成立，下面证明当\(n=k\)时定理也成立.

由\cref{theorem:特征值与特征向量.实对称矩阵1}，
\(\A\)的特征值全为实数.
假设\(\lambda_1\)是\(\A\)的特征值，
并且相应地存在非零实向量\(\X1=(\AutoTuple{c}{n})^T\)，
使得\[
	\A\X1=\lambda_1\X1.
\]
不妨设\(c_1\neq0\)，则\(n\)元向量组\[
	\X1,\X2=(0,1,\dotsc,0)^T,\dotsc,\X{n}=(0,0,\dotsc,1)^T
\]线性无关.
对向量组\(X=\{\AutoTuple{\vb{x}}{n}\}\)
用施密特正交规范化方法可得规范正交组\(Y=\{\AutoTuple{\y}{n}\}\)，
则\(\P=(\AutoTuple{\y}{n})\)是正交矩阵，
其中\(\y_1=\abs{\X1}^{-1}\X1\)是\(\A\)的特征向量.

因为\(\mathbb{R}^n\)中任意\(n+1\)个向量线性相关，
故任意向量都可由\(Y\)线性表出，
即\begin{align*}
	\A\y_1 &= \lambda_1\y_1 = \lambda_1\y_1 + 0\y_2 + \dotsb + 0\y_n, \\
	\A\y_k &= b_{1k}\y_1 + b_{2k}\y_2 + \dotsb + b_{nk}\y_n \quad(k=2,3,\dotsc,n),
\end{align*}
由分块矩阵乘法，\[
	\A(\AutoTuple{\y}{n})
	= (\AutoTuple{\y}{n})
	\begin{bmatrix}
		\lambda_1 & b_{11} & \dots & b_{1n} \\
		0 & b_{22} & \dots & b_{2n} \\
		\vdots & \vdots & & \vdots \\
		0 & b_{n2} & \dots & b_{nn}
	\end{bmatrix},
\]
令\(\P=(\AutoTuple{\y}{n})\)，
显然\(\P\)是正交阵，
而\(\P^{-1}\A\P=\P^T\A\P=\begin{bmatrix}
	\lambda_1 & \a \\
	\z & \B
\end{bmatrix}\).

由\((\P^T\A\P)^T=\P^T\A^T\P=\P^T\A\P\)可知\(\begin{bmatrix}
	\lambda_1 & \a \\
	\z & \B
\end{bmatrix}
= \begin{bmatrix}
	\lambda_1 & \z \\
	\a^T & \B^T
\end{bmatrix}\)，
于是\(\a=\z\)，\(\B=\B^T\)，也就是说\(\B\)是\(n-1\)阶实对称矩阵.
又由归纳假设，存在\(n-1\)阶正交阵\(\M\)，使得\(\M^{-1}\B\M\)成为对角阵.

令\(\Q=\P\begin{bmatrix} 1 & \z \\ \z & \M \end{bmatrix}\)，
因为\(\Q\Q^T=\Q^T\Q=\E\)，所以\(\Q\)是正交矩阵，
而\begin{align*}
	\Q^{-1}\A\Q
	&=\begin{bmatrix}
		1 & \z \\
		\z & \M^{-1}
	\end{bmatrix}\P^{-1}\A\P\begin{bmatrix}
		1 & \z \\
		\z & \M
	\end{bmatrix}=\begin{bmatrix}
		1 & \z \\
		\z & \M^{-1}
	\end{bmatrix}\begin{bmatrix}
		\lambda_1 & \z \\
		\z & \B
	\end{bmatrix}\begin{bmatrix}
		1 & \z \\
		\z & \M
	\end{bmatrix} \\
	&=\begin{bmatrix}
		\lambda_1 & \z \\
		\z & \M^{-1}\B\M
	\end{bmatrix}
	=\diag(\AutoTuple{\lambda}{n}).
\end{align*}
由上可知当\(n=k\)时定理也成立.
\end{proof}
\end{theorem}

\cref{theorem:特征值与特征向量.实对称矩阵3} 表明，
实对称矩阵总可以相似对角化，
或者说，实对称矩阵总是\DefineConcept{正交相似}（{orthogonally similar}）于某个对角形矩阵.

从\cref{theorem:特征值与特征向量.矩阵相似的必要条件3} 我们已经知道
\(\A\sim\B \implies \abs{\lambda\E-\A}=\abs{\lambda\E-\B}\).
但对于一般的同阶矩阵\(\A,\B\)，
我们不能肯定\cref{theorem:特征值与特征向量.矩阵相似的必要条件3} 的逆命题一定成立.
但是对于实对称矩阵来说，
只要加上一个额外条件“\(\A\)与\(\B\)的特征值相同”，
就可以依靠\cref{theorem:特征值与特征向量.实对称矩阵3} 证明\(\A\)与\(\B\)相似.
\begin{corollary}
%@see: 《线性代数》（张慎语、周厚隆） P113 习题5.3 1(2)
%@see: 《线性代数》（张慎语、周厚隆） P113 习题5.3 9(1)
设\(\A,\B\)是同阶实对称矩阵，
则\[
	\A\sim\B
	\iff
	\abs{\lambda\E-\A}=\abs{\lambda\E-\B}.
\]
\end{corollary}

\begin{corollary}
%@see: 《线性代数》（张慎语、周厚隆） P110 推论
\(n\)阶实对称矩阵\(\A\)存在\(n\)个正交的单位特征向量.
\end{corollary}

\begin{remark}
\color{red}
对于实对称矩阵\(\A\)，求正交矩阵\(\Q\)，使得\(\Q^{-1}\A\Q\)为对角形矩阵的方法：
\begin{enumerate}
	\item 求出\(\A\)的全部不同的特征值\(\AutoTuple{\lambda}{m}\)；
	\item 求出\((\lambda_i\E-\A)\vb{x}=\z\)的基础解系，将其正交化，
	得到\(\A\)属于\(\lambda_i\ (i=1,2,\dotsc,m)\)的正交特征向量，
	共求出\(\A\)的\(n\)个正交特征向量；
	\item 将以上\(n\)个正交特征向量单位化，由所得向量作为列构成正交矩阵\(\Q\)，则\[
		\Q^{-1}\A\Q = \Q^T \A \Q = \diag(\AutoTuple{\lambda}{n}).
	\]
\end{enumerate}
\end{remark}

\begin{example}
%@see: 《线性代数》（张慎语、周厚隆） P112 例5
设\(\A\)为\(n\)阶实对称矩阵，\(\A\)是对合矩阵，证明：存在正交矩阵\(\Q\)，使得\[
	\Q^{-1}\A\Q=\begin{bmatrix} \E_r \\ & -\E_{n-r} \end{bmatrix}.
\]
\begin{proof}
因为\(\A\)为\(n\)阶实对称矩阵，
则\(\A\)有\(n\)个实特征值，
\(\A\)有\(n\)个正交的单位特征向量，
适当调整它们的顺序，可以构成正交矩阵\(\Q\)，
满足\begin{gather}
	\Q^{-1}\A\Q=\diag(\AutoTuple{\lambda}{n}), \tag1
\end{gather}
其中，\(\lambda_i>0\ (i=1,2,\dotsc,r),
\lambda_i\leq0\ (i=r+1,r+2,\dotsc,n)\).
对(1)式两端分别平方，
又由\(\A\)是对合矩阵，满足\(\A^2=\E\)，
得\[
	\Q^{-1}\A^2\Q
	= \Q^{-1}\E\Q
	= \E
	= \diag(\lambda_1^2,\lambda_2^2,\dotsc,\lambda_n^2),
\]
于是\(\lambda_i^2=1\ (i=1,2,\dotsc,n)\)，
进而有\[
	\lambda_i= \begin{cases}
		1, & i=1,2,\dotsc,r, \\
		-1, & i=r+1,r+2,\dotsc,n.
	\end{cases}
	\qedhere
\]
\end{proof}
\end{example}

\begin{example}
设\(\A\)是4阶实对称矩阵，且\(\A^2+\A=\z\).
若\(\rank\A=3\)，求\(\A\)的特征值以及与\(\A\)相似的对角阵.
\begin{solution}
\(\A\)是实对称矩阵，根据\cref{theorem:特征值与特征向量.实对称矩阵3}，
\(\A\)一定可对角化，不妨设\(\A\vb{x}=\lambda\vb{x}\ (\vb{x}\neq0)\)，
那么\(\A^2\vb{x}=\lambda^2\vb{x}\)，\((\A^2+\A)\vb{x}=(\lambda^2+\lambda)\vb{x}\).
因为\(\A^2+\A=\z\)，所以\((\lambda^2+\lambda)\vb{x}=\z\)，\(\lambda^2+\lambda=0\)，
解得\(\A\)的特征值为\(\lambda=0,-1\).
又因为\(\rank\A=3\)，所以\(\A\)具有3个非零特征值，
因此与\(\A\)相似的对角阵为\(\diag(-1,-1,-1,0)\).
\end{solution}
\end{example}

\begin{example}
设\(\A\)是特征值仅为1与0的\(n\)阶实对称矩阵，证明：\(\A\)是幂等矩阵.
\begin{proof}
\def\M{\begin{bmatrix} \E_r \\ & \z_{n-r} \end{bmatrix}}%
因为\(\A\)是实对称矩阵，所以存在正交矩阵\(\Q\)使得\[
	\Q^{-1}\A\Q = \M,
\]
从而有\[
	\A = \Q\M\Q^{-1},
\]
进而有\[
	\A^2 = \Q\M\Q^{-1}\Q\M\Q^{-1} = \Q\M\Q^{-1} = \A.
	\qedhere
\]
\end{proof}
\end{example}

\begin{example}
%@see: 《线性代数》（张慎语、周厚隆） P113 习题5.3 7.
设\(\A\)为\(n\)阶实对称矩阵，满足\(\A^2=\z\)，证明：\(\A=\z\).
\begin{proof}
因为\(\A\)是实对称矩阵，所以存在正交矩阵\(\Q\)使得\[
	\Q^{-1}\A\Q = \diag(\AutoTuple{\lambda}{n}) = \V,
\]
从而有\(\A = \Q\V\Q^{-1}\)，\(\A^2 = (\Q\V\Q^{-1})^2 = \Q\V^2\Q^{-1} = \z\)，那么\[
	\V^2 = \diag(\lambda_1^2,\lambda_2^2,\dotsc,\lambda_n^2) = \Q^{-1}\z\Q = \z,
\]\[
	\lambda_1=\lambda_2=\dotsb=\lambda_n = 0,
\]
所以\(\A=\z\).
\end{proof}
\end{example}
