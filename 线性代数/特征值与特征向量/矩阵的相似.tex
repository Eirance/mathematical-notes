\section{矩阵的相似}
有时候，我们会遇到这样的问题：
已知\(\A\)是数域\(K\)上的一个\(n\)阶方阵，求\(\A^m\).
这时候，如果存在数域\(K\)上的一个\(n\)阶可逆矩阵\(\P\)，
使得\(\P^{-1}\A\P = \B\)，并且\(\B^m\)容易计算，
那么我们就可以利用矩阵的乘法结合律得到以下结果：\[
	\A^m
	= (\P^{-1}\B\P)^m
	= \underbrace{
			(\P^{-1}\B\P)
			(\P^{-1}\B\P)
			\dotsm
			(\P^{-1}\B\P)
		}_{\text{$m$个}}
	= \P^{-1}\B^m\P.
\]

\subsection{矩阵相似的概念}
\begin{definition}
%@see: 《线性代数》（张慎语、周厚隆） P97 定义3
%@see: 《高等代数（第三版 上册）》（丘维声） P169 定义1
设\(\A\)、\(\B\)是两个\(n\)阶矩阵.
若存在可逆矩阵\(\P\)，
使得\begin{equation}\label{equation:特征值与特征向量.相似矩阵的定义}
	\P^{-1}\A\P=\B
\end{equation}
则称“\(\A\)与\(\B\)~\DefineConcept{相似}%
（\(\A\) is \emph{similar} to \(\B\)）”，
%@see: https://mathworld.wolfram.com/SimilarMatrices.html
记作\(\A\sim\B\).
\end{definition}

\subsection{矩阵相似的性质}
\begin{proposition}
%@see: 《高等代数（第三版 上册）》（丘维声） P169 命题1
%@see: 《线性代数》（张慎语、周厚隆） P97 性质2
设矩阵\(\A_1,\A_2,\B_1,\B_2,\P \in M_n(K)\)，\(\P\)可逆，
且\[
	\B_1=\P^{-1}\A_1\P, \qquad
	\B_2=\P^{-1}\A_2\P,
\]
则\begin{gather}
	\B_1 + \B_2 = \P^{-1} (\A_1 + \A_2) \P, \\
	\B_1 \B_2 = \P^{-1} (\A_1 \A_2) \P, \\
	m\in\mathbb{N} \implies \B_1^m = \P^{-1}\A_1^m\P.
		\label{equation:相似矩阵.利用相似性简化计算}
\end{gather}
\end{proposition}

\begin{property}\label{theorem:特征值与特征向量.矩阵相似的必要条件1}
%@see: 《线性代数》（张慎语、周厚隆） P97 性质1
%@see: 《高等代数（第三版 上册）》（丘维声） P169 1°
相似矩阵的行列式相等.
\begin{proof}
设\(\A,\B \in M_n(K)\).
假设\(\A\sim\B\)，
那么存在数域\(K\)上\(n\)阶可逆矩阵\(\P\)，
使得\[
	\P^{-1}\A\P=\B,
\]
两端取行列式，得\[
	\abs{\B} = \abs{\P^{-1}\A\P}
	= \abs{\P^{-1}}\abs{\A}\abs{\P}
	= \abs{\P}^{-1}\abs{\A}\abs{\P}
	= \abs{\A}.
	\qedhere
\]
\end{proof}
\end{property}
\begin{proposition}
%@see: 《高等代数（第三版 上册）》（丘维声） P169 2°
设\(\A,\B \in M_n(K)\).
若\(\A\sim\B\)，则\(\A\)和\(\B\)同为可逆或不可逆.
\begin{proof}
由\cref{theorem:特征值与特征向量.矩阵相似的必要条件1} 立即可得.
\end{proof}
\end{proposition}
\begin{remark}
如果\(\A_1,\B_1\)可逆，
那么\cref{equation:相似矩阵.利用相似性简化计算}
可以推广为\(m\in\mathbb{Z} \implies \B_1^m = \P^{-1}\A_1^m\P\).
这也说明：
相似矩阵的同次幂也相似.
\end{remark}

\begin{property}\label{theorem:特征值与特征向量.矩阵相似的必要条件3}
%@see: 《线性代数》（张慎语、周厚隆） P97 性质3
相似矩阵有相同的特征多项式，从而有相同的特征值.
\begin{proof}
设\(\A,\B \in M_n(K)\).
假设\(\A\sim\B\)，
那么存在数域\(K\)上\(n\)阶可逆矩阵\(\P\)，
使得\[
	\P^{-1}\A\P=\B,
\]
于是\[
	\abs{\l\E-\B}
	=\abs{\P^{-1}(\l\E-\A)\P}
	=\abs{\P^{-1}}\abs{\l\E-\A}\abs{\P}
	=\abs{\l\E-\A}.
	\qedhere
\]
\end{proof}
\end{property}
\begin{remark}
\cref{theorem:特征值与特征向量.矩阵相似的必要条件3} 只是矩阵相似的必要不充分条件.
下面我们举出一条反例，不相似的两个矩阵有相同的特征多项式和特征值.
取\[
	\A = \begin{bmatrix} 2 & 1 \\ 0 & 2 \end{bmatrix},
	\quad\text{和}\quad
	\B = \begin{bmatrix} 2 & 0 \\ 0 & 2 \end{bmatrix},
\]
显然两者的特征多项式相同，都是\((\lambda-2)^2\)，
故而两者的特征值也相同，都是\(\l=2\ (\text{二重})\).
但\(\A\)与\(\B\)不相似，
这是因为\(\B=2\E\)是数乘矩阵，可以和所有二阶矩阵交换，
那么对任意二阶可逆矩阵\(\P\)都有\(\P^{-1}\B\P=\B\P^{-1}\P=\B\)，
即\(\B\)只能与自身相似，
\(\A\)与\(\B\)不相似.
\end{remark}

\begin{property}\label{theorem:特征值与特征向量.矩阵相似的必要条件4}
%@see: 《高等代数（第三版 上册）》（丘维声） P170 4°
相似矩阵有相同的迹.
\begin{proof}
假设\(\A\sim\B\)，
那么存在数域\(K\)上\(n\)阶可逆矩阵\(\P\)，
使得\[
	\P^{-1}\A\P=\B,
\]
于是由\cref{theorem:矩阵的迹.矩阵乘积交换次序不变迹} 有\[
	\tr\B
	= \tr(\P^{-1}\A\P)
	= \tr(\P(\P^{-1}\A))
	= \tr\A.
	\qedhere
\]
\end{proof}
\end{property}

\begin{property}\label{theorem:特征值与特征向量.矩阵相似的必要条件5}
%@see: 《高等代数（第三版 上册）》（丘维声） P170 3°
相似矩阵有相同的秩.
\begin{proof}
由\cref{theorem:矩阵乘积的秩.与可逆矩阵相乘不变秩} 可得.
\end{proof}
\end{property}

\begin{property}
相似矩阵与原矩阵等价，即\(\A\sim\B \implies \A\cong\B\).
\begin{proof}
由于\hyperref[theorem:特征值与特征向量.矩阵相似的必要条件5]{相似矩阵的秩相等}，
而\hyperref[theorem:矩阵乘积的秩.矩阵等价的充分必要条件]{秩相等的矩阵等价}，
所以相似矩阵必定等价.
\end{proof}
\end{property}

\begin{remark}
由\cref{theorem:特征值与特征向量.矩阵相似的必要条件1,theorem:特征值与特征向量.矩阵相似的必要条件4,theorem:特征值与特征向量.矩阵相似的必要条件5} 可知，
数域\(K\)上的\(n\)阶方阵的行列式、秩、迹
都是相似关系下的不变量，
我们把这三个量统称为\DefineConcept{相似不变量}.
\end{remark}

\begin{example}
已知矩阵\(\A = \begin{bmatrix}
	2 & 0 & 0 \\
	0 & 0 & 1 \\
	0 & 1 & x
\end{bmatrix}\)与\(\B = \begin{bmatrix}
	2 & 0 & 0 \\
	0 & y & 0 \\
	0 & 0 & -1
\end{bmatrix}\)相似.
求\(x\)与\(y\).
\begin{solution}
因为\(\A\sim\B\)，所以，由\cref{theorem:特征值与特征向量.矩阵相似的必要条件1}，
\[
	\begin{vmatrix}
		2 & 0 & 0 \\
		0 & 0 & 1 \\
		0 & 1 & x
	\end{vmatrix}
	= -2 = -2y =
	\begin{vmatrix}
		2 & 0 & 0 \\
		0 & y & 0 \\
		0 & 0 & -1
	\end{vmatrix}
	\implies y = 1;
\]
又由\cref{theorem:特征值与特征向量.矩阵相似的必要条件4}，
\[
	\tr\A = 2+x
	= 1+y = \tr\B
	\implies
	x = 0.
\]
\end{solution}
\end{example}

\begin{example}
%@see: 《2024年全国硕士研究生入学统一考试（数学一）》一选择题/第7题
设\(\vb{A}\)是秩为2的3阶矩阵，
\(\vb\alpha\)是满足\(\vb{A} \vb\alpha = \vb0\)的非零向量，
若对满足\(\vb\beta^T \vb\alpha = \vb0\)的3维列向量\(\vb\beta\)，
均有\(\vb{A} \vb\beta = \vb\beta\)，
求\(\tr\vb{A}^3\).
\begin{solution}
由于\(\vb{A} \vb\alpha = \vb0\)且\(\vb\alpha \neq \vb0\)，
所以\(\lambda_1 = 0\)是\(\vb{A}\)的一个特征值.

易知子空间\(\Set{\vb\beta \given \vb\beta^T \vb\alpha = 0}\)的维数为\[
	\dim\Set{\vb\beta \given \vb\beta^T \vb\alpha = 0} = 2,
\]
那么在其中必定存在两个线性无关的非零向量\(\vb\beta_1,\vb\beta_2\)，
使得\(\vb\beta_1^T \vb\alpha
= \vb\beta_2^T \vb\alpha
= \vb0\)，
从而有\(\vb{A}\vb\beta_1 = \vb\beta_1,
\vb{A}\vb\beta_2 = \vb\beta_2\)，
于是\(\lambda_2 = 1\ (\text{二重})\)是\(\vb{A}\)的一个特征值.

由\cref{theorem:特征值与特征向量.矩阵相似的必要条件4}
可知\(\tr\vb{A}^3
= \tr\vb{A}^2
= \tr\vb{A}
= 1+1+0
= 2\).
\end{solution}
\end{example}

\subsection{相似类}
\begin{property}\label{theorem:特征值与特征向量.相似关系是等价关系}
%@see: 《线性代数》（张慎语、周厚隆） P97
%@see: 《高等代数（第三版 上册）》（丘维声） P169
数域\(K\)上的\(n\)阶矩阵之间的相似关系，
是数域\(K\)上的全体\(n\)阶矩阵\(M_n(K)\)上的等价关系，
因为它满足：\begin{itemize}
	\item {\rm\bf 反身性}：
	\((\forall \A \in M_n(K))
	[\A\sim\A]\).

	\item {\rm\bf 对称性}：
	\((\forall \A,\B \in M_n(K))
	[\A \sim \B \implies \B \sim \A]\).

	\item {\rm\bf 传递性}：
	\((\forall \A,\B,\C \in M_n(K))
	[\A \sim \B, \B \sim \C \implies \A \sim \C]\).
\end{itemize}
\begin{proof}
在\cref{equation:特征值与特征向量.相似矩阵的定义} 中，
令\(\A=\B\)、\(\P=\E\)，得\(\E\A\E=\A\)，
即有相似矩阵的反身性成立.

再在\cref{equation:特征值与特征向量.相似矩阵的定义} 中取\(\Q=\P^{-1}\)，
得\(\A = \Q^{-1}(\P^{-1}\A\P)\Q = \Q^{-1}\B\Q\)，即有相似矩阵的对称性成立.

设\(\P_1^{-1}\A\P_1=\B,
\P_2^{-1}\B\P_2=\C\)，
于是\(\P_2^{-1}(\P_1^{-1}\A\P_1)\P_2=\C\).
取\(\Q=\P_1\P_2\)，\(\Q\)是可逆矩阵，且\(\Q^{-1}\A\Q=\C\)，所以\(\A\sim\C\)，
即有相似矩阵的传递性成立.
\end{proof}
\end{property}

\begin{definition}
%@see: 《高等代数（第三版 上册）》（丘维声） P169
把矩阵\(\A \in M_n(K)\)在相似关系下的等价类\[
	\Set{ \B \in M_n(K) \given \A\sim\B }
\]称为“矩阵\(\A\)的\DefineConcept{相似类}”.
\end{definition}

\begin{example}
%@see: 《高等代数（第三版 上册）》（丘维声） P171 习题5.4 1.
设矩阵\(\A,\B \in M_n(K)\).
证明：如果\(\A \sim \B\)，则\begin{gather}
	(\forall k \in K)
	[k\A \sim k\B], \\
	\A^T \sim \B^T.
\end{gather}
\begin{proof}
假设可逆矩阵\(\P\)满足\[
	\P^{-1}\A\P = \B,
\]
那么由矩阵运算规律可知，
对于\(\forall k \in K\)，
成立\[
	\P^{-1}(k\A)\P
	= k(\P^{-1}\A\P)
	= k\B,
	\quad\text{和}\quad
	\P^T\A^T(\P^T)^{-1}
	= (\P^{-1}\A\P)^T
	= \B^T,
\]
因此\(k\A \sim k\B\)且\(\A^T \sim \B^T\).
\end{proof}
\end{example}
\begin{example}
设矩阵\(\A\)可逆，\(\A^T\)是\(\A\)的转置.
证明：\(\A\A^T \sim \A^T\A\).
\begin{proof}
取\(\P=\A^{-1}\)，
则\(\P^{-1}=\A\)，\(\P\A=\A\P=\E\)，
于是\[
	\P(\A\A^T)\P^{-1}
	= (\P\A)(\A^T\P^{-1})
	= \A^T\P^{-1}
	= \A^T\A,
\]
故\(\A\A^T \sim \A^T\A\).
\end{proof}
\end{example}
\begin{example}
%@see: 《高等代数（第三版 上册）》（丘维声） P171 习题5.4 2.
设矩阵\(\A,\B \in M_n(K)\).
证明：如果\(\A\)可逆，则\(\A\B \sim \B\A\).
\begin{proof}
因为\(\A^{-1}(\A\B)\A
= \B\A\)，
所以\(\A\B \sim \B\A\).
\end{proof}
\end{example}
\begin{example}
%@see: 《高等代数（第三版 上册）》（丘维声） P171 习题5.4 3.
设矩阵\(\A_1,\B_1 \in M_s(K),
\A_2,\B_2 \in M_n(K)\).
证明：如果\(\A_1 \sim \B_1,\A_2 \sim \B_2\)，
则\[
	\begin{bmatrix}
		\A_1 & \vb0 \\
		\vb0 & \A_2
	\end{bmatrix}
	\sim \begin{bmatrix}
		\B_1 & \vb0 \\
		\vb0 & \B_2
	\end{bmatrix}.
\]
\begin{proof}
假设可逆矩阵\(\P_1 \in M_s(K)\)
和可逆矩阵\(\P_2 \in M_n(K)\)满足\[
	\P_1^{-1} \A_1 \P_1 = \B_1,
	\qquad
	\P_2^{-1} \A_2 \P_2 = \B_2,
\]
那么\[
	\begin{bmatrix}
		\P_1^{-1} & \vb0 \\
		\vb0 & \P_2^{-1}
	\end{bmatrix}
	\begin{bmatrix}
		\A_1 & \vb0 \\
		\vb0 & \A_2
	\end{bmatrix}
	\begin{bmatrix}
		\P_1 & \vb0 \\
		\vb0 & \P_2
	\end{bmatrix}
	= \begin{bmatrix}
		\P_1^{-1} \A_1 \P_1 & \vb0 \\
		\vb0 & \P_2^{-1} \A_2 \P_2
	\end{bmatrix}
	= \begin{bmatrix}
		\B_1 & \vb0 \\
		\vb0 & \B_2
	\end{bmatrix}.
	\qedhere
\]
\end{proof}
\end{example}
\begin{example}
%@see: 《高等代数（第三版 上册）》（丘维声） P171 习题5.4 6.
证明：单位矩阵只与它本身相似.
\begin{proof}
设\(\A \in M_n(K)\)，
\(\E\)是数域\(K\)上的\(n\)阶单位矩阵，
且\(\E \sim \A\).
根据矩阵相似的定义，
存在可逆\(\P \in M_n(K)\)，
使得\(\P^{-1} \E \P = \A\).
又因为单位矩阵可以与任意同阶矩阵交换，
所以\(\A
= \P^{-1} \E \P
= \P^{-1} \P \E
= \E \E
= \E\).
\end{proof}
\end{example}
\begin{example}
%@see: 《高等代数（第三版 上册）》（丘维声） P171 习题5.4 7.
证明：数量矩阵只与它本身相似.
\begin{proof}
设\(\A \in M_n(K)\)，
\(\E\)是数域\(K\)上的\(n\)阶单位矩阵，
\(k \in K\)，
且\(k\E \sim \A\).
根据矩阵相似的定义，
存在可逆\(\P \in M_n(K)\)，
使得\(\P^{-1} (k\E) \P = \A\)，
于是\(\A = k\E\).
\end{proof}
\end{example}
\begin{example}
%@see: 《高等代数（第三版 上册）》（丘维声） P171 习题5.4 10.
证明：与幂等矩阵相似的矩阵仍是幂等矩阵.
\begin{proof}
假设\(\A\)是数域\(K\)上的一个\(n\)阶幂等矩阵，
即\(\A^2=\A\).
假设\(\A\)与数域\(K\)上的某个\(n\)阶矩阵\(\B\)相似，
那么存在可逆矩阵\(\P\)，使得\[
	\P^{-1}\A\P = \B,
\]
从而有\[
	\P\B^2\P^{-1}
	= (\P\B\P^{-1})(\P\B\P^{-1})
	= \A^2
	= \A
	= \P\B\P^{-1},
\]
于是\(\B^2=\B\)，
即\(\B\)也是幂等矩阵.
\end{proof}
\end{example}
\begin{example}
%@see: 《高等代数（第三版 上册）》（丘维声） P171 习题5.4 11.
证明：与对合矩阵相似的矩阵仍是对合矩阵.
\begin{proof}
假设\(\E\)是数域\(K\)上的\(n\)阶单位矩阵，
\(\A\)是数域\(K\)上的一个\(n\)阶对合矩阵，
即\(\A^2=\E\).
假设\(\A\)与数域\(K\)上的某个\(n\)阶矩阵\(\B\)相似，
那么存在可逆矩阵\(\P\)，使得\[
	\P^{-1}\A\P = \B,
\]
从而有\[
	\P\B^2\P^{-1}
	= (\P\B\P^{-1})(\P\B\P^{-1})
	= \A^2
	= \E,
\]
于是\(\B^2=\E\)，
即\(\B\)也是对合矩阵.
\end{proof}
\end{example}
\begin{example}
%@see: 《高等代数（第三版 上册）》（丘维声） P171 习题5.4 12.
证明：与幂零矩阵相似的矩阵仍是幂零矩阵.
\begin{proof}
假设\(\A\)是数域\(K\)上的一个以\(m\)为幂零指数的\(n\)阶幂零矩阵，
即\(\A^m=\vb0\).
假设\(\A\)与数域\(K\)上的某个\(n\)阶矩阵\(\B\)相似，
那么存在可逆矩阵\(\P\)，使得\[
	\P^{-1}\A\P = \B,
\]
从而有\[
	\P\B^m\P^{-1}
	= (\P\B\P^{-1})^m
	= \A^m
	= \vb0,
\]
于是\(\B^m=\vb0\)，
即\(\B\)也是以\(m\)为幂零指数的幂零矩阵.
\end{proof}
\end{example}
