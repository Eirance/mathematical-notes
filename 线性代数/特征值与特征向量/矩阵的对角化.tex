\section{矩阵的对角化}
\begin{definition}
%@see: 《高等代数（第三版 上册）》（丘维声） P171
设矩阵\(\A \in M_n(K)\).
\begin{itemize}
	\item 如果存在\(n\)阶对角矩阵\(\vb\Lambda\)相似于\(\A\)，
	则称“矩阵\(\A\)可以\DefineConcept{对角化}”
	“矩阵\(\vb\Lambda\)是\(\A\)的\DefineConcept{相似标准型}”.
	\item 如果不存在\(n\)阶对角矩阵相似于\(\A\)，
	则称“矩阵\(\A\)不可以\DefineConcept{对角化}”.
\end{itemize}
\end{definition}

\begin{theorem}[矩阵可对角化的充分必要条件]\label{theorem:矩阵可对角化的充分必要条件.定理1}
%@see: 《高等代数（第三版 上册）》（丘维声） P171 定理2
设矩阵\(\A \in M_n(K)\)，
则\(\A\)可对角化的充分必要条件是：
\(\A\)有\(n\)个线性无关的特征向量.
\begin{proof}
必要性.
假设\(\A\)可对角化，
即存在数域\(K\)上的\(n\)阶可逆矩阵\(\P=(\AutoTuple{\x}{n})\)
和数域\(K\)上的\(n\)阶对角阵\(\vb\Lambda=\diag(\AutoTuple{\lambda}{n})\)，
使\[
	\P^{-1}\A\P=\V.
\]
用\(\P\)左乘上式两端，得\[
	\A\P=\P\V.
\]
由于\(\P\)可逆，所以\(\AutoTuple{\x}{n}\)线性无关，有\[
	\A(\AutoTuple{\x}{n})=(\AutoTuple{\x}{n})\V,
\]\[
	(\A\vb{x}_1,\A\vb{x}_2,\dotsc,\A\vb{x}_n)=(\vb{x}_1\V,\vb{x}_2\V,\dotsc,\vb{x}_n\V),
\]
于是\[
	\A\vb{x}_i=\lambda_i\vb{x}_i,
	\quad i=1,2,\dotsc,n,
\]
即\(\AutoTuple{\x}{n}\)是矩阵\(\A\)的
分别属于\(\AutoTuple{\lambda}{n}\)的\(n\)个线性无关的特征向量.

同理可证充分性.
\end{proof}
\end{theorem}

由上述定理的证明可知：
{\color{red}当\(\P^{-1}\A\P=\V\)时，
\(\V\)的\(n\)个主对角元是\(\A\)的\(n\)个特征值；
可逆矩阵\(\P\)的\(n\)个列向量\(\AutoTuple{\x}{n}\)是
\(\A\)分别属于\(\lambda_1,\lambda_2,\dotsc,\lambda_n\)的线性无关特征向量.}

\begin{theorem}
矩阵\(\A\)的属于不同特征值的特征向量线性无关.
\begin{proof}
设\(n\)阶矩阵\(\A\)的\(m\)个不同的特征值\(\lambda_1,\lambda_2,\dotsc,\lambda_m\)
对应的特征向量分别为\(\AutoTuple{\x}{m}\).

由上述所有特征向量构成的向量组，
记作\(X_m=\{\AutoTuple{\x}{m}\}\).

当\(m=1\)时，
由于\(\vb{x}_1 \neq 0\)，
故向量组\(X_1=\{\vb{x}_1\}\)线性无关.

当\(m>1\)时，
假设\(m-1\)个不同特征值对应的特征向量\(X_{m-1}=\{\AutoTuple{\x}{m-1}\}\)线性无关.
对于\(m\)个不同特征值对应的特征向量组\(X_m\)，
令\begin{gather}
	k_1\vb{x}_1+k_2\vb{x}_2+\dotsb+k_m\vb{x}_m=\z,
	\tag1
\end{gather}
由于\(\A\vb{x}_j=\lambda_j\vb{x}_j\)，
用\(\A\)左乘(1)式两端，
得\begin{gather}
	k_1\lambda_1\vb{x}_1+k_2\lambda_2\vb{x}_2
	+\dotsb+k_{m-1}\L{m-1}\X{m-1}+k_m\lambda_m\vb{x}_m=\z.
	\tag2
\end{gather}
再用\(\lambda_m\)数乘(1)式两端，得\begin{gather}
	\lambda_mk_1\vb{x}_1+\lambda_mk_2\vb{x}_2
	+\dotsb+\lambda_mk_{m-1}\X{m-1}+\lambda_mk_m\vb{x}_m=\z,
	\tag3
\end{gather}
(2)、(3)两式相减，得\begin{gather}
	(\lambda_1-\lambda_m)k_1\vb{x}_1+(\lambda_2-\lambda_m)k_2\vb{x}_2
	+\dotsb+(\L{m-1}-\lambda_m)k_{m-1}\X{m-1}=\z.
	\tag4
\end{gather}
根据归纳假设，向量组\(X_{m-1}\)线性无关，
则\((\lambda_i-\lambda_m)k_i=0\ (i=1,2,\dotsc,m-1)\).
由于\(\lambda_i\neq\lambda_m\ (i=1,2,\dotsc,m-1)\)，
所以\(k_1=k_2=\dotsb=k_{m-1}=0\)，得\(k_m\vb{x}_m=\z\)，
但特征向量\(\vb{x}_m\neq\z\)，则\(k_m=0\)，从而向量组\(X_m\)线性无关.
\end{proof}
\end{theorem}

\begin{corollary}[矩阵可对角化的充分条件]\label{theorem:矩阵可对角化的充分条件.定理1}
若\(n\)阶矩阵\(\A\)有\(n\)个不同的特征值，则\(\A\)可对角化.
\end{corollary}

\begin{theorem}
设\(\lambda_1,\lambda_2,\dotsc,\lambda_m\)是\(n\)阶矩阵\(\A\)的不同的特征值，
而\(\vb{x}_{ij}\ (j=1,2,\dotsc)\)是\(\A\)属于\(\lambda_i\ (i=1,2,\dotsc,m)\)的线性无关的特征向量，
即\[
	\A \vb{x}_{ij} = \lambda_i \vb{x}_{ij},
	\quad i=1,2,\dotsc,m;j=1,2,\dotsc,
\]
则\[
	\vb{x}_{11},\vb{x}_{12},\dotsc,\vb{x}_{21},\vb{x}_{22},\dotsc,\vb{x}_{m1},\vb{x}_{m2},\dotsc
\]线性无关.
\end{theorem}

\begin{example}
设\[
	\A = \begin{bmatrix}
		1 & 0 & 0 \\
		-2 & 5 & -2 \\
		-2 & 4 & -1
	\end{bmatrix}.
\]
试问：\(\A\)能否对角化？
若能，则求出可逆矩阵\(\P\)，使\(\P^{-1}\A\P\)为对角形矩阵.
\begin{solution}
\(\A\)的特征多项式为\[
	\abs{\l\E-\A} = \begin{bmatrix}
		\l-1 & 0 & 0 \\
		2 & \l-5 & 2 \\
		2 & -4 & \l+1
	\end{bmatrix}
	= (\l-1)^2 (\l-3),
\]
则\(\A\)的特征值为\(\lambda_1=1\)（二重），\(\lambda_2=3\).

当\(\lambda_1=1\)时，解齐次线性方程组\((\E-\A)\x=\z\)，\[
	\E-\A=\begin{bmatrix}
		0 & 0 & 0 \\
		2 & -4 & 2 \\
		2 & -4 & 2
	\end{bmatrix}
	\to \begin{bmatrix}
		1 & -2 & 1 \\
		0 & 0 & 0 \\
		0 & 0 & 0
	\end{bmatrix},
\]
基础解系为\(\vb{x}_1 = \begin{bmatrix} 2 \\ 1 \\ 0 \end{bmatrix},
\vb{x}_2 = \begin{bmatrix} -1 \\ 0 \\ 1 \end{bmatrix}\).

对于\(\lambda_2=3\)，解方程组\((3\E-\A)\x=\z\)，\[
	3\E-\A=\begin{bmatrix}
		2 & 0 & 0 \\
		2 & -2 & 2 \\
		2 & -4 & 4
	\end{bmatrix} \to \begin{bmatrix}
		2 & 0 & 0 \\
		0 & -2 & 2 \\
		0 & 0 & 0
	\end{bmatrix},
\]
基础解系为\(\vb{x}_3 = \begin{bmatrix} 0 \\ 1 \\ 1 \end{bmatrix}\).

特征向量\(\vb{x}_1,\vb{x}_2,\vb{x}_3\)线性无关，所以\(\A\)可以对角化.
令\[
	\P = \begin{bmatrix} \vb{x}_1 & \vb{x}_2 & \vb{x}_3 \end{bmatrix} = \begin{bmatrix}
		2 & -1 & 0 \\
		1 & 0 & 1 \\
		0 & 1 & 1
	\end{bmatrix},
	\quad\text{则有}\quad
	\P^{-1} \A \P = \begin{bmatrix} 1 \\ & 1 \\ && 3 \end{bmatrix}.
\]
\end{solution}
\end{example}

\begin{example}
设\(\A = \begin{bmatrix}
	2 & 0 & 0 \\
	0 & 2 & 0 \\
	0 & 1 & 2
\end{bmatrix}\)，证明：\(\A\)不可对角化.
\begin{proof}
\(\A\)的特征多项式为\[
	\abs{\l\E-\A} = \begin{vmatrix}
		\l-2 & 0 & 0 \\
		0 & \l-2 & 0 \\
		0 & -1 & \l-2
	\end{vmatrix} = (\l-2)^2,
\]
令\(\abs{\l\E-\A} = 0\)解得特征值\(\lambda_1=2\)（三重）.
由于\(\rank(\lambda_1\E-\A)=1\)，
那么对应于唯一的特征值\(\lambda_1=2\)，
\(\A\)只有两个线性无关的特征向量，
因而不存在可逆矩阵\(\P\)使得\(\P^{-1}\A\P\)为对角形矩阵.
\end{proof}
\end{example}

从上述例子可以看出，当矩阵\(\A\)的某个特征值\(\L0\)为\(k\)重根式，
对应于\(\L0\)的线性无关的特征向量的个数可能等于\(k\)，
也可能小于\(k\).这个规律对于一般的矩阵是成立的.

\begin{theorem}
设\(\L0\)为\(n\)阶矩阵\(\A\)的\(k\)重特征值，
则属于\(\L0\)的\(\A\)的线性无关的特征向量最多只有\(k\)个.
\end{theorem}

\begin{theorem}\label{theorem:矩阵可对角化的充分必要条件.定理2}
\(n\)阶矩阵\(\A\)可对角化的充分必要条件是：
对于\(\A\)的每个\(k_i\)重特征值\(\lambda_i\)，
\(\A\)有\(k_i\)个线性无关的特征向量.
\end{theorem}

\begin{corollary}\label{theorem:矩阵可对角化的充分必要条件.定理3}
\(n\)阶矩阵\(\A\)可对角化的充分必要条件是：
对于\(\A\)的每个\(k_i\)重特征值\(\lambda_i\)，
都有\(\rank(\lambda_i\E-\A) = n-k_i\).
\end{corollary}

\begin{example}
设\(\A\)、\(\B\)是\(n\)阶矩阵，且\(\A\)可逆，证明：\(\A\B\)与\(\B\A\)相似.
\begin{proof}
因为\(\A\)可逆，则\[
	\B\A
	=\E\B\A
	=(\A^{-1}\A)\B\A
	=\A^{-1}(\A\B)\A,
\]
根据定义可得\(\A\B \sim \B\A\).
\end{proof}
\end{example}

\begin{example}
设\(\A\)为可逆矩阵且可对角化，证明：\(\A^{-1}\)也可对角化.
\begin{proof}
设存在可逆矩阵\(\P\)使得\begin{gather}
	\P^{-1}\A\P = \V,
	\tag1
\end{gather}
其中\(\V=\diag(\lambda_1,\lambda_2,\dotsc,\lambda_n)\)，
\(n\)是矩阵\(\A\)的阶数，
\(\lambda_1,\lambda_2,\dotsc,\lambda_n\)是矩阵\(\A\)的特征值.
显然有\(\abs{\V}
= \abs{\P^{-1}\A\P}
= \abs{\P^{-1}}\abs{\A}\abs{\P}
= (\abs{\P^{-1}}\abs{\P})\abs{\A}
= 1 \cdot \abs{\A}
= \abs{\A} \neq 0\)，
即\(\V\)可逆.
在(1)式两端左乘\(\P\)得\(\P(\P^{-1}\A\P) = \P\V\)
即\begin{gather}
	\A\P = \P\V.
	\tag2
\end{gather}
在(2)式两端左乘\(\P^{-1}\A^{-1}\)，
右乘\(\V^{-1}\)得\[
	(\P^{-1}\A^{-1})(\A\P)\V^{-1} = (\P^{-1}\A^{-1})(\P\V)\V^{-1},
\]
即\(\V^{-1} = \P^{-1}\A^{-1}\P\).
\end{proof}
\end{example}

\begin{example}
设\(m\)阶矩阵\(\A\)与\(n\)阶矩阵\(\B\)都可对角化，证明：\(m+n\)阶矩阵\[
	\begin{bmatrix} \A & \z \\ \z & \B \end{bmatrix}
\]可对角化.
\begin{proof}
设存在\(m\)阶可逆矩阵\(\P\)和\(n\)阶可逆矩阵\(\Q\)使得
\begin{align*}
	\P^{-1}\A\P &= \V_1 \\
	\Q^{-1}\B\Q &= \V_2
\end{align*}
则可构造矩阵使得\[
	\begin{bmatrix}
		\P^{-1} & \z \\
		\z & \Q^{-1}
	\end{bmatrix}
	\begin{bmatrix} \A & \z \\ \z & \B \end{bmatrix}
	\begin{bmatrix}
		\P & \z \\
		\z & \Q
	\end{bmatrix}
	= \begin{bmatrix}
		\V_1 & \z \\
		\z & \V_2
	\end{bmatrix}.
	\qedhere
\]
\end{proof}
\end{example}

\begin{example}
设\(\A\)是非零的幂零矩阵，
即\(\A\neq\z\)，且存在自然数\(m\)，使得\(\A^m=\z\).
证明：\(\A\)的特征值全为零，且\(\A\)不可以对角化.
\begin{proof}
设存在非零列向量\(\vb{x}_0\)，使得\(\A\vb{x}_0=\L0\vb{x}_0\)成立，则\[
\A^m\vb{x}_0=\L0^m\vb{x}_0.
\]
令\(\A^m=\z\)，则解\(\A^m\vb{x}_0=\z=\L0^m\vb{x}_0\)得\(\L0=0\)，可见\(\A\)的特征值全为零.

假设\(\A\)可以对角化，即存在可逆矩阵\(\P\)使得\[
	\P^{-1}\A\P = \diag(\lambda_1,\lambda_2,\dotsc,\lambda_n) = \z.
\]
在等式两边同时左乘\(\P\)，并右乘\(\P^{-1}\)，得\[
	\A = \P(\P^{-1}\A\P)\P^{-1} = \P\z\P^{-1} = \z.
\]矛盾，故\(\A\)不可以对角化.
\end{proof}
\end{example}

\begin{example}
设\(\A \in M_n(K)\)，
\(\rank\A=1\).
证明：\[
	\tr\A\neq0
	\iff
	\text{\(\A\)可相似对角化}.
\]
\begin{proof}
因为\(\rank\A=1
\iff
(\exists\a,\b \in K^n-\{\vb0\})[\A=\a\b^T]\)，
所以根据\cref{example:矩阵乘积的秩.两个向量的乘积的特征值和特征向量}，
\(\A\)的特征值为\(\tr\A\)和\(0\ (\text{$n-1$重})\).
又因为\(\rank(0\E-\A)=\rank\A=1\)，
所以根据\cref{theorem:矩阵可对角化的充分必要条件.定理3} 可知，
\(\A\)可以对角化.
\end{proof}
\end{example}

\begin{example}
\def\J{\vb{J}_n}
形式为\[
	\J = \begin{bmatrix}
		\L0 & 0 & 0 & \dots & 0 & 0 \\
		1 & \L0 & 0 & \dots & 0 & 0 \\
		0 & 1 & \L0 & \dots & 0 & 0 \\
		\vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\
		0 & 0 & 0 & \dots & \L0 & 0 \\
		0 & 0 & 0 & \dots & 1 & \L0
	\end{bmatrix}_n
\]的复数三角形阵称为\DefineConcept{若尔当块}.
证明：\(n>1\)阶若尔当块不可以对角化.
\begin{proof}
令\(\abs{\l\E-\J}=(\lambda-\L0)^n=0\)，解得\(\l=\L0\)（\(n\)重），那么\[
	\L0\E-\J = \begin{bmatrix}
		0 \\
		-1 & 0 \\
		& -1 & 0 \\
		& & \ddots & \ddots \\
		& & & -1 & 0
	\end{bmatrix}_n,
\]
\(\rank(\L0\E-\J)=n-1 > 0\)，
故当\(n>1\)时\(\J\)不可以对角化.
\end{proof}
\end{example}

\begin{definition}
由若干个若尔当块构成的准对角矩阵称为\DefineConcept{若尔当形矩阵}.
\end{definition}

\begin{theorem}
每个\(n\)阶复数矩阵不一定与对角阵相似，但必与一个若尔当形矩阵相似.
\end{theorem}
