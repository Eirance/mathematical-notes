\section{面积原理}
\begin{theorem}
设\(m\)是正整数，\(f\)是在\([m,+\infty)\)上非负的单调增加的函数，
那么对于\(\forall \xi>m\)，
有\[
	\abs{
		\sum_{k=m}^{\floor{\xi}} f(k)
		- \int_m^\xi f(x) \dd{x}
	} \leq f(\xi).
\]
\begin{proof}
由\cref{theorem:取整函数.性质1} 可知，
\(\floor{\xi} \leq \xi < \xi + 1\)，
于是\[
	\int_m^\xi f(x) \dd{x}
	= \int_m^{\floor{\xi}} f(x) \dd{x}
	+ \int_{\floor{\xi}}^\xi f(x) \dd{x}.
\]
利用定积分的几何意义，容易看出\[
	f(m) + f(m+1) + \dotsb + f(\floor{\xi}-1)
	\leq \int_m^{\floor{\xi}} f(x) \dd{x}
	\leq f(m+1) + f(m+2) + \dotsb + f(\floor{\xi}).
\]
又因为\(f\)是单调增加的，
\(f(\xi)\)是\(f\)在\([m,\xi]\)上的最大值，
由\cref{theorem:定积分.定积分性质6} 有\[
	0 \leq \int_{\floor{\xi}} f(x) \dd{x}
	\leq f(\xi) (\xi - \floor{\xi})
	\leq f(\xi),
\]
所以\[
	f(m) + f(m+1) + \dotsb + f(\floor{\xi}-1)
	\leq \int_m^\xi f(x) \dd{x}
	\leq f(m+1) + f(m+2) + \dotsb + f(\floor{\xi}) + f(\xi).
\]
在上式等号两边同时减去\(\sum_{k=m}^{\floor{\xi}} f(k)
= f(m) + f(m+1) + \dotsb + f(\floor{\xi})\)，
便得\[
	-f(\xi)
	\leq -f(\floor{\xi})
	\leq \int_m^\xi f(x) \dd{x} - \sum_{k=m}^{\floor{\xi}} f(k)
	\leq f(\xi) - f(m)
	\leq f(\xi).
\]
于是\[
	\abs{\int_m^\xi f(x) \dd{x} - \sum_{k=m}^{\floor{\xi}} f(k)} \leq f(\xi).
	\qedhere
\]
\end{proof}
\end{theorem}

\begin{example}
\(\abs{\sum_{k=1}^n k^p - \int_1^n x^p \dd{x}}
= \abs{1^p+\dotsb+n^p - \frac{n^{p+1}-1}{p+1}}
\leq n^p\).
%TODO 怎么丢掉常数\(\frac1{p+1}\)，
%得到\(\abs{1^p+\dotsb+n^p-\frac{n^{p+1}}{p+1}}\)？
%从这里可以进一步得到
%\(\abs{\frac{1^p+\dotsb+n^p}{n^{p+1}}-\frac1{p+1}} \leq \frac1n\).
\end{example}

\begin{example}
\(\abs{\sum_{k=1}^n \ln k - \int_1^n \ln x \dd{x}}
= \abs{\ln n! - \ln\left[\left(\frac{n}{e}\right)^n e\right]}
\leq \ln n\).
\end{example}
\begin{remark}
打开绝对值符号，
立即可以得到\[
	\ln\left[\left(\frac{n}{e}\right)^n \frac{e}{n}\right]
	\leq \ln n!
	\leq \ln\left[\left(\frac{n}{e}\right)^n e n\right],
\]
从而有\[
	\left(\frac{n}{e}\right)^n \frac{e}{n}
	\leq n!
	\leq \left(\frac{n}{e}\right)^n e n.
\]
\end{remark}

\begin{theorem}
设\(m\)是正整数，\(f\)是在\([m,+\infty)\)上非负的单调减少的函数，
则极限\[
	\lim\limits_{n\to\infty} \left(
	\sum\limits_{k=m}^n f(k)
	- \int_m^n f(t) \dd{t}
	\right)
	= \alpha
\]存在，
且\(\alpha\in[0,f(m)]\).
\begin{proof}
记\(g(x)
= \sum\limits_{k=m}^{\floor{x}} f(k)
- \int_m^x f(t) \dd{t}\)，
那么\[
	g(n) - g(n+1)
	= -f(n+1)
	+ \int_n^{n+1} f(t) \dd{t}.
\]
因为\[
	\int_n^{n+1} f(t) \dd{t}
	\geq
	1 \cdot f(n+1),
\]
所以\(g(n) - g(n+1) \geq 0\)，\(\{g(n)\}\)单调性得证.

又因为\begin{align*}
	g(n)
	&= \sum\limits_{k=m}^{n-1} f(k) - \int_m^n f(t) \dd{t} \\
	&= \sum\limits_{k=m}^{n-1} \left[
			f(k) - \int_k^{k+1} f(t) \dd{t}
		\right] + f(n) \\
	&\geq \sum\limits_{k=m}^{n-1} [f(k) - f(k)] + f(n)
	= f(n) \geq 0,
\end{align*}
这就是说\(\{g(n)\}\)是非负的单调减少的数列，
从而\(\{g(n)\}\)有界性得证.

因此，根据单调有界定理，\(\alpha = \lim\limits_{n\to\infty} g(n)\)存在.
又由\(0 \leq g(n) \leq g(m) = f(m)\)
可知\(0 \leq \alpha \leq f(m)\).
\end{proof}
%@see: https://encyclopediaofmath.org/wiki/Area_principle
\end{theorem}
\begin{remark}
取\(m=1\)和\(f(x) = \frac1x\)，
立即可得\cref{example:微分中值定理.拉格朗日中值定理.欧拉--马歇罗尼常数} 的结论.
\end{remark}

\begin{corollary}
设\(m\)是正整数，\(f\)是在\([m,+\infty)\)上非负的单调减少的函数，
且\(\lim_{x\to+\infty} f(x) = 0\)，
则\[
	\abs{
		\sum\limits_{k=m}^{\floor{\xi}} f(k)
		- \int_m^\xi f(t) \dd{t}
		- \alpha
	} \leq f(\xi-1),
\]
其中\(\alpha = \lim\limits_{n\to\infty} \left(
	\sum\limits_{k=m}^{\floor{\xi}} f(k)
	- \int_m^\xi f(t) \dd{t}
\right)\).
\end{corollary}
