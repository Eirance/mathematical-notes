\section{定积分的换元积分法}
由上节结果知道，计算定积分\(\int_a^b f(x) \dd{x}\)的简便方法是
把它转化为求\(f(x)\)的原函数的增量.
在\cref{chapter:不定积分}中，
我们知道用换元积分法和分部积分法可以求出一些函数的原函数.
因此，在一定条件下，可以用换元积分法和分部积分法来计算定积分.
下面就来讨论定积分的这两种计算方法.

为了说明如何用换元法来计算定积分，先证明下面的定理.
\begin{theorem}\label{theorem:定积分.定积分的换元法}
%@see: 《数学分析（第二版 上册）》（陈纪修） P303 定理7.3.4
设函数\(f \in C[a,b]\)，
函数\(\phi \in C^1[\alpha,\beta]\)，
\(\ran\phi \subseteq [a,b]\)，
\(\phi(\alpha)=a,
\phi(\beta)=b\)，
则有\begin{equation}\label{equation:定积分.定积分的换元公式}
	\int_a^b f(x) \dd{x} = \int_\alpha^\beta f[\phi(t)] \phi'(t) \dd{t}.
\end{equation}
\begin{proof}
由假设可知，
被积函数\(f(x)\)和\(f[\phi(t)] \phi'(t)\)都是连续的，
因此不仅\cref{equation:定积分.定积分的换元公式} 两边的定积分都存在，
而且由\hyperref[theorem:定积分.原函数存在定理]{原函数存在定理}知道，
被积函数的原函数也都存在.
所以\cref{equation:定积分.定积分的换元公式} 两边的定积分
都可应用\hyperref[equation:定积分.牛顿--莱布尼茨公式]{牛顿--莱布尼茨公式}.
假设\(F(x)\)是\(f(x)\)的一个原函数，则\[
	\int_a^b f(x) \dd{x} = F(b) - F(a).
\]
另一方面，记\(\Phi(t) = F[\phi(t)]\)，
它是由\(F(x)\)与\(x=\phi(t)\)复合而成的函数.
由复合函数求导法则，得\[
	\Phi'(t) = \dv{F}{x} \dv{x}{t}
	= f(x) \phi'(t)
	= f[\phi(t)] \phi'(t).
\]
这表明\(\Phi(t)\)是\(f[\phi(t)] \phi'(t)\)的一个原函数，
因此有\[
	\int_\alpha^\beta f[\phi(t)] \phi'(t) \dd{t}
	= \Phi(\beta) - \Phi(\alpha).
\]
又由\(\Phi(t) = F[\phi(t)]\)，
\(\phi(\alpha) = a\)，
\(\phi(\beta) = b\)，
可得\[
	\Phi(\beta) - \Phi(\alpha)
	= F[\phi(\beta)] - F[\phi(\alpha)]
	= F(b) - F(a).
\]
所以\[
	\int_a^b f(x) \dd{x}
	= F(b) - F(a)
	= \Phi(\beta) - \Phi(\alpha)
	= \int_\alpha^\beta f[\phi(t)] \phi'(t) \dd{t}.
	\qedhere
\]
\end{proof}
\end{theorem}
在定积分\(\int_a^b f(x) \dd{x}\)中的\(\dd{x}\)，本来是整个定积分记号中不可分割的一部分，但由上述定理可知，在一定条件下，它确实可以作为微分记号来对待.
这就是说，应用换元公式时，如果把\(\int_a^b f(x) \dd{x}\)中的\(x\)换成\(\phi(t)\)，则\(\dd{x}\)就换成\(\phi'(t) \dd{t}\)，这正好是\(x = \phi(t)\)的微分\(\dd{x}\).

应用换元公式时，有两点值得注意：\begin{enumerate}
\item 用\(x = \phi(t)\)把原来变量\(x\)代换成新变量\(t\)时，积分限也要换成相应于新变量\(t\)的积分限；
\item 求出\(f[\phi(t)] \phi'(t)\)的一个原函数\(\Phi(t)\)后，不必像计算不定积分那样再要把\(\Phi(t)\)变换成原来变量\(x\)的函数，而只要把新变量\(t\)的上、下限分别代入\(\Phi(t)\)中然后相减就行了.
\end{enumerate}

\begin{example}
%@see: 《高等数学（第六版 上册）》 P246 例1
计算\(\int_0^a \sqrt{a^2-x^2} \dd{x}\ (a > 0)\).
\begin{solution}
令\(x = a \sin t\ (-\frac\pi2 \leq t \leq \frac\pi2)\)，
则\[
	\dd{x} = a \cos t \dd{t}, \qquad
	\sqrt{a^2-x^2} = a \cos t.
\]
当\(x = 0\)时，取\(t = 0\).
当\(x = a\)时，取\(t = \frac{\pi}{2}\).
那么有\[
	\int_0^a \sqrt{a^2-x^2} \dd{x}
	= \int_0^{\frac{\pi}{2}} a \cos t \cdot a \cos t \dd{t}
	= \frac{a^2}{2} \int_0^{\frac{\pi}{2}} (1+\cos 2 t) \dd{t}
	= \frac{\pi a^2}{4}.
\]
\end{solution}
\end{example}

\begin{proposition}\label{theorem:定积分.利用对称性简化计算0}
设\(f \in R[-a,a]\).
证明：\begin{equation}
	\int_{-a}^a f(x) \dd{x} = \int_0^a [f(x) + f(-x)] \dd{x}.
\end{equation}
\begin{proof}
由\cref{theorem:定积分.定积分性质3} 有\[
	\int_{-a}^a f(x) \dd{x}
	= \int_{-a}^0 f(x) \dd{x}
	+ \int_0^a f(x) \dd{x};
\]
由\cref{equation:定积分.交换上下限改变定积分的符号} 有\[
	\int_{-a}^0 f(x) \dd{x}
	\xlongequal{x=-t} \int_a^0 f(-t) \dd(-t)
	= \int_0^a f(-t) \dd{t}
	= \int_0^a f(-x) \dd{x};
\]
故由\cref{theorem:定积分.定积分性质1} 有\[
	\int_{-a}^a f(x) \dd{x}
	= \int_0^a f(-x) \dd{x} + \int_0^a f(x) \dd{x}
	= \int_0^a [f(-x) + f(x)] \dd{x}.
	\qedhere
\]
\end{proof}
\end{proposition}

\begin{proposition}\label{theorem:定积分.利用对称性简化计算1}
%@see: 《数学分析（第二版 上册）》（陈纪修） P308 定理7.3.5
设\(f \in R[-a,a]\).
\begin{itemize}
	\item 若函数\(f\)在区间\([-a,a]\)上是偶函数，
	则\[
		\int_{-a}^a f(x) \dd{x}
		= 2 \int_0^a f(x) \dd{x};
	\]

	\item 若函数\(f\)在区间\([-a,a]\)上是奇函数，
	则\[
		\int_{-a}^a f(x) \dd{x} = 0.
	\]
\end{itemize}
\begin{proof}
由\cref{theorem:定积分.利用对称性简化计算0} 有\[
	\int_{-a}^a f(x) \dd{x}
	= \int_0^a [f(-x) + f(x)] \dd{x}.
\]

接下来我们对函数\(f\)分情况讨论.
\begin{itemize}
	\item 若\(f\)是偶函数，则\[
		f(x) + f(-x) = 2 f(x),
	\]
	从而\[
		\int_{-a}^a f(x) \dd{x} = 2 \int_0^a f(x) \dd{x};
	\]

	\item 若\(f\)是奇函数，则\[
		f(x) + f(-x) = 0,
	\]
	从而\[
		\int_{-a}^a f(x) \dd{x} = 0.
		\qedhere
	\]
\end{itemize}
\end{proof}
\end{proposition}

\begin{remark}
常用\cref{theorem:定积分.利用对称性简化计算1} 简化奇、偶函数在对称于原点的区间上的定积分.

当积分区间不是关于原点对称的区间时，
我们可以利用坐标变换公式，
对被积函数换元，
将积分区间平移，把它变成对称于原点的区间.

当我们处理非奇非偶函数函数\(f\)时，
可以利用我们从\cref{example:函数.任一函数可拆为奇偶函数之和} 得到的公式\[
	g(x) = \frac{f(x) + f(-x)}{2}, \qquad
	h(x) = \frac{f(x) - f(-x)}{2},
\]
将\(f\)中的偶函数\(g\)和奇函数\(h\)分别抽离出，
再利用\cref{theorem:定积分.利用对称性简化计算1} 简化计算.
\end{remark}

\begin{example}
%@see: 《数学分析（第二版 上册）》（陈纪修） P311 习题 9. (1)
设\(f \in C[0,1]\).
证明：\begin{gather}
	\int_0^{\frac\pi2} f(\sin x) \dd{x}
	= \int_0^{\frac\pi2} f(\cos x) \dd{x}, \\
	\int_0^\pi x f(\sin x) \dd{x}
	= \frac{\pi}{2} \int_0^\pi f(\sin x) \dd{x}.
\end{gather}
\begin{proof}
显然有\begin{align*}
	\int_0^{\frac\pi2} f(\sin x) \dd{x}
	&\xlongequal{x = \pi/2-t}
		\int_{\frac\pi2}^0 f\left[\sin(\frac{\pi}{2}-t)\right] \dd(\frac{\pi}{2}-t) \\
	&= \int_0^{\frac\pi2} f(\cos x) \dd{x}.
		\tag{\cref{equation:函数.三角函数.诱导公式10}}
\end{align*}

因为\begin{align*}
	\int_0^\pi x f(\sin x) \dd{x}
	&\xlongequal{x = \pi-t}
		\int_{\pi}^0 (\pi-t) f[\sin(\pi-t)] \dd(\pi-t) \\
	&= \int_0^\pi (\pi-x) f(\sin x) \dd{x}
		\tag{\cref{equation:函数.三角函数.诱导公式5}} \\
	&= \pi \int_0^\pi f(\sin x) \dd{x}
		- \int_0^\pi x f(\sin x) \dd{x},
\end{align*}
所以\[
	\int_0^\pi x f(\sin x) \dd{x}
	= \frac{\pi}{2} \int_0^\pi f(\sin x) \dd{x}.
	\qedhere
\]
\end{proof}
\end{example}

\begin{example}
%@see: 《高等数学（第六版 上册）》 P254 习题5-3 5.
设\(f \in C[0,1]\)，且\(n\in\mathbb{Z}\).
证明：\begin{equation}
	\int_{\frac{n}{2} \pi}^{\frac{n+1}{2} \pi} f(\abs{\sin x}) \dd{x}
	= \int_{\frac{n}{2} \pi}^{\frac{n+1}{2} \pi} f(\abs{\cos x}) \dd{x}
	= \int_0^{\frac{\pi}{2}} f(\sin x) \dd{x}.
\end{equation}
\def\arraystretch{1.5}
\begin{proof}
令\(x = n\pi+\frac{\pi}{2}-t\)，
则有\begin{align*}
	\int_{\frac{n}{2} \pi}^{\frac{n+1}{2} \pi} f(\abs{\sin x}) \dd{x}
	&= \int_{\frac{n+1}{2} \pi}^{\frac{n}{2} \pi} f\left[\abs{\pm\sin(\frac{\pi}{2}-t)}\right] \dd(\frac{2n+1}{2}\pi-t) \\
	&= \int_{\frac{n}{2} \pi}^{\frac{n+1}{2} \pi} f(\abs{\cos x}) \dd{x}.
\end{align*}

又令\(x=u+\frac{n}{2} \pi\)，
则有\begin{align*}
	\int_{\frac{n}{2} \pi}^{\frac{n+1}{2} \pi} f(\abs{\cos x}) \dd{x}
	&= \int_0^{\frac{1}{2}\pi} f\left[ \abs{\cos(u+\frac{\pi}{2})} \right] \dd(u+\frac{n}{2}\pi) \\
	&= \int_0^{\frac{1}{2}\pi} f\left( \abs{-\sin u} \right) \dd{u} \\
	&= \int_0^{\frac{1}{2}\pi} f(\sin x) \dd{x}.
	\qedhere
\end{align*}
\end{proof}
\end{example}

\begin{example}
%@see: 《数学分析（第二版 上册）》（陈纪修） P309 定理7.3.6
设函数\(f\)是以\(T\)为周期的黎曼可积函数.
证明：\begin{gather}
	\int_a^{a+T} f(x) \dd{x} = \int_0^T f(x) \dd{x}, \\
	\int_a^{a+nT} f(x) \dd{x} = n\int_0^T f(x) \dd{x}
	\quad(n \in \mathbb{N}).
\end{gather}
\begin{proof}
记\(\Phi(a) = \int_a^{a+T} f(x) \dd{x}\).
利用\cref{theorem:定积分.变限积分定理}，
对\(a\)求导得\[
	\dv{a} \Phi(a) = f(a+T) - f(a) = 0,
\]
这就是说\(\Phi(a)\)与\(a\)无关，
于是\(\Phi(a) = \Phi(0)\)，即\[
	\int_a^{a+T} f(x) \dd{x} = \int_0^T f(x) \dd{x};
\]
由此可得\[
	\int_a^{a+nT} f(x) \dd{x}
	= \sum_{k=0}^{n-1} \int_{a+kT}^{(a+kT)+T} f(x) \dd{x}
	= \sum_{k=0}^{n-1} \int_0^T f(x) \dd{x}
	= n \int_0^T f(x) \dd{x}.
	\qedhere
\]
\end{proof}
\end{example}

\begin{example}
%@see: 《高等数学（第六版 上册）》 P254 习题5-3 6.
证明：\begin{itemize}
	\item 若\(f\)是连续的奇函数，则\(\int_0^x f(t) \dd{t}\)是偶函数.
	\item 若\(f\)是连续的偶函数，则\(\int_0^x f(t) \dd{t}\)是奇函数.
\end{itemize}
\begin{proof}
设\(F(x) = \int_0^x f(t) \dd{t}\)，
那么\[
	F(-x) = \int_0^{-x} f(t) \dd{t}
	\xlongequal{t=-u} \int_0^x f(-u) \dd(-u).
\]
\begin{itemize}
	\item 若\(f\)是连续的奇函数，那么\(f(-u) = -f(u)\)，所以\[
		F(-x) = \int_0^x f(u) \dd{u} = F(x),
	\]
	即\(F\)是偶函数；

	\item 若\(f\)是连续的偶函数，那么\(f(-u) = f(u)\)，所以\[
		F(-x) = -\int_0^x f(u) \dd{u} = -F(x),
	\]
	即\(F\)是奇函数.
	\qedhere
\end{itemize}
\end{proof}
\end{example}

\begin{example}
%@see: 《高等数学（第六版 上册）》 P254 习题5-3 2.
设\(f \in C[a,b]\).
证明：\[
	\int_a^b f(x) \dd{x}
	= \int_a^b f(a+b-x) \dd{x}.
\]
\begin{proof}
令\(x=a+b-t\)，
则\(\dd{x} = -\dd{t}\).
当\(x=a\)时，取\(t=b\).
当\(x=b\)时，取\(t=a\).
于是\[
	\int_a^b f(x) \dd{x}
	= \int_b^a f(a+b-t) \dd(-t)
	= \int_a^b f(a+b-t) \dd{t}.
	\qedhere
\]
\end{proof}
\end{example}
如果换元前后的被积函数的线性组合\[
	k_1 f(x) + k_2 f(a+b-x)
\]恒为一个常数，
即\[
	k_1 f(x) + k_2 f(a+b-x) = c,
\]
其中\(c\)是常数，
就可以化简被积函数，
得到\[
	(k_1 + k_2) \int_a^b f(x) \dd{x}
	= \int_a^b [k_1 f(x) + k_2 f(a+b-x)] \dd{x}
	= c \int_a^b \dd{x} = c(b-a),
\]
于是\[
	\int_a^b f(x) \dd{x}
	= \frac{c(b-a)}{k_1 + k_2}.
\]

\begin{example}
计算定积分\(\int_0^{\frac{\pi}{2}} \frac{\sin x}{\sin x + \cos x} \dd{x}\).
\begin{solution}
设\(I = \int_0^{\frac{\pi}{2}} \frac{\sin x}{\sin x + \cos x} \dd{x}\).
因为
\begin{align*}
	I &= \int_0^{\frac{\pi}{2}}
		\frac{\sin\left(\frac{\pi}{2}-t\right)}
			{\sin\left(\frac{\pi}{2}-t\right) + \cos\left(\frac{\pi}{2}-t\right)}
		\dd{t} \\
	&= \int_0^{\frac{\pi}{2}} \frac{\cos t}{\cos t + \sin t} \dd{t},
\end{align*}
所以\[
	2 I = \int_0^{\frac{\pi}{2}} \frac{\sin x}{\sin x + \cos x} \dd{x}
		+ \int_0^{\frac{\pi}{2}} \frac{\cos x}{\sin x + \cos x} \dd{x}
	= \int_0^{\frac{\pi}{2}} \dd{x}
	= \frac{\pi}{2},
\]
从而\(I = \pi/4\).
\end{solution}
\end{example}

\begin{example}
设\(f \in C[0,2a]\).
证明：\begin{equation}
	\int_0^{2a} f(x) \dd{x} = \int_0^a [f(x) + f(2a-x)] \dd{x}.
\end{equation}
\begin{proof}
由\cref{theorem:定积分.定积分性质3} 有\[
	\int_0^{2a} f(x) \dd{x}
	= \int_0^a f(x) \dd{x} + \int_a^{2a} f(x) \dd{x};
\]
由\cref{equation:定积分.交换上下限改变定积分的符号} 有\[
	\int_a^{2a} f(x) \dd{x}
	\xlongequal{x=2a-t} \int_a^0 f(2a-t) \dd(2a-t)
	= \int_0^a f(2a-t) \dd{t}
	= \int_0^a f(2a-x) \dd{x};
\]
故由\cref{theorem:定积分.定积分性质1} 有\[
	\int_0^{2a} f(x) \dd{x}
	= \int_0^a f(x) \dd{x} + \int_0^a f(2a-x) \dd{x}
	= \int_0^a [f(x) + f(2a-x)] \dd{x}.
	\qedhere
\]
\end{proof}
\end{example}
