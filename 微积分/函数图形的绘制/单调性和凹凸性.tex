\section{函数的单调性与曲线的凹凸性}
\subsection{函数单调性的判定法}
\begin{theorem}[函数的单调性]
设函数\(y=f(x)\)在\([a,b]\)上连续，在\((a,b)\)内可导.
\begin{enumerate}
\item 如果在\((a,b)\)内\(f'(x)>0\)，那么函数\(y=f(x)\)在\([a,b]\)上单调增加；
\item 如果在\((a,b)\)内\(f'(x)<0\)，那么函数\(y=f(x)\)在\([a,b]\)上单调减少.
\end{enumerate}
如果将上述判定定理中的闭区间换成其他各种区间（包括无穷区间），结论也成立.
\end{theorem}

如果函数在定义区间上连续，除去有限个导数不存在的点外导数存在且连续，那么只要用方程\(f'(x) = 0\)的根及\(f'(x)\)不存在的点来划分函数\(f(x)\)的定义区间，就能保证\(f'(x)\)在各个部分区间内保持固定符号，因而函数\(f(x)\)在每个部分区间上单调.

一般地，如果\(f'(x)\)在某区间内的有限个点处为零，在其余各点处均为正（或负）时，那么\(f(x)\)在该区间上仍旧是单调增加（或单调减少）的.

\begin{example}
证明：当\(x > 1\)时，\(2 \sqrt{x} > 3 - \frac{1}{x}\).
\begin{proof}
令\(f(x) = 2 \sqrt{x} - \left(3 - \frac{1}{x}\right)\)，则\[
f'(x) = \frac{1}{\sqrt{x}} - \frac{1}{x^2}
= \frac{1}{x^2} (x \sqrt{x} - 1).
\]

\(f(x)\)在\([1,+\infty)\)上连续，在\((1,+\infty)\)内\(f'(x) > 0\)，因此在\([1,+\infty)\)上\(f(x)\)单调增加，从而当\(x > 1\)时，\(f(x) > f(1) = 0\)，即\(2 \sqrt{x} - \left(3 - \frac{1}{x}\right) > 0\)，\(2 \sqrt{x} > 3 - \frac{1}{x}\).
\end{proof}
\end{example}

\begin{example}
证明\DefineConcept{若尔当不等式}：
当\(0<x<\frac\pi2\)时，
有\begin{equation}\label{equation:微分中值定理.若尔当不等式}
	\frac2\pi < \frac{\sin x}{x} < 1.
\end{equation}
\begin{proof}
设\(f(x) = \frac{\sin x}{x}\ (0<x<\frac\pi2)\)，
那么\(f'(x) = \frac{x\cos x - \sin x}{x^2}\).
又设\(g(x) = x \cos x - \sin x\)，
那么\[
	g'(x) = \cos x - x \sin x - \cos x = -x \sin x < 0\ (0<x<\frac\pi2),
\]
说明\(g\)是\((0,\frac\pi2)\)上的单调减少函数.
又因为\(g(0) = 0\)，
从而\(g(x) < 0\ (0<x<\frac\pi2)\)，
所以\(f'(x) < 0\)，
\(f\)也是\((0,\frac\pi2)\)上的单调减少函数.
应用洛必达法则，得\[
	\lim_{x\to0^+} f(x)
	= \lim_{x\to0^+} \cos x
	= 1.
\]
再因为\[
	\lim_{x\to\frac\pi2^-} f(x)
	= \frac{\sin(\pi/2)}{\pi/2}
	= \frac2\pi,
\]
所以\[
	\frac2\pi < \frac{\sin x}{x} < 1.
	\qedhere
\]
\end{proof}
\end{example}

\begin{example}
证明：
当\(0<x<\frac\pi2\)时，
有\[
	\tan x > x.
\]
\begin{proof}
设\(f(x) = \tan x - x\ (0<x<\frac\pi2)\).
求导得\(f'(x) = \sec^2 x - 1 = \tan^2 x\).
显然\(f'(x) > 0\ (0<x<\frac\pi2)\)，
\(f\)是\((0,\frac\pi2)\)上的严格单调增加函数.
又因为\(f(0) = \tan0 - 0 = 0\)，
所以\(f(x) = \tan x - x > 0\ (0<x<\frac\pi2)\)，
即\(\tan x > x\ (0<x<\frac\pi2)\).
\end{proof}
\end{example}

\subsection{曲线的凹凸性与拐点}
\begin{definition}
%@see: 《数学分析》（卓里奇） P202 定义1.
%@see: 《数学分析》（卓里奇） P203 定义2.
设函数\(f\colon D\to\mathbb{R}\)，其中\(D=(a,b)\subset\mathbb{R}\).

若\[
	(\forall x_1,x_2 \in D)
	(\forall \lambda \in [0,1])
	[
		f(\lambda x_1 + (1-\lambda) x_2)
		\leq
		\lambda f(x_1) + (1-\lambda) f(x_2)
	],
\]
则称“\(f(x)\)是\(D\)上的\DefineConcept{凹函数}（convex function）”.

若\[
	(\forall x_1,x_2 \in D)
	(\forall \lambda \in [0,1])
	[
		f(\lambda x_1 + (1-\lambda) x_2)
		\geq
		\lambda f(x_1) + (1-\lambda) f(x_2)
	],
\]
则称“\(f(x)\)是\(D\)上的\DefineConcept{凸函数}（concave function）”.

若\[
	(\forall x_1,x_2 \in D)
	[
		x_1 \neq x_2
		\implies
		(\forall \lambda \in (0,1))
		[
			f(\lambda x_1 + (1-\lambda) x_2)
			<
			\lambda f(x_1) + (1-\lambda) f(x_2)
		]
	],
\]
则称“\(f(x)\)是\(D\)上的\DefineConcept{严格凹函数}
（strictly convex function）”.

若\[
	(\forall x_1,x_2 \in D)
	[
		x_1 \neq x_2
		\implies
		(\forall \lambda \in (0,1))
		[
			f(\lambda x_1 + (1-\lambda) x_2)
			>
			\lambda f(x_1) + (1-\lambda) f(x_2)
		]
	],
\]
则称“\(f(x)\)是\(D\)上的\DefineConcept{严格凸函数}
（strictly concave function）”.
%@see: https://mathworld.wolfram.com/ConvexFunction.html
%@see: https://mathworld.wolfram.com/ConcaveFunction.html
%@see: https://doi.org/10.1007/978-3-030-41804-5
\end{definition}

\begin{definition}
设函数\(f\colon D\to\mathbb{R}\).

若\[
	(\exists\alpha>0)
	[\text{函数\(g(x)=f(x)-\alpha\abs{x}^2\)是凹函数}],
\]
则称“\(f(x)\)是\(D\)上的\DefineConcept{强凹函数}
（strongly convex function）”.

若\[
	(\exists\alpha>0)
	[\text{函数\(g(x)=f(x)-\alpha\abs{x}^2\)是凸函数}],
\]
则称“\(f(x)\)是\(D\)上的\DefineConcept{强凸函数}
（strongly concave function）”.
%@see: https://www.princeton.edu/~aaa/Public/Teaching/ORF523/S16/ORF523_S16_Lec7_gh.pdf
\end{definition}

\begin{proposition}
强凹（凸）函数必定严格凹（凸）.
\end{proposition}

\begin{proposition}[延森不等式]
%@see: 《数学分析》（卓里奇） P207 命题7.
如果\(f\colon(a,b)\to\mathbb{R}\)是凸函数，
\(\AutoTuple{x}{n}\in(a,b)\)，
\(\AutoTuple{k}{n}\in(0,1)\)
且\(\AutoTuple{k}{n}[+]=1\)，
则\[
	f(k_1x_1+\dotsb+k_nx_n)
	\leq
	k_1f(x_1)+\dotsb+k_nf(x_n).
\]
\end{proposition}

\begin{theorem}[曲线凹凸的判定]\label{theorem:微分中值定理.曲线凹凸的判定}
设\(f(x)\)在\([a,b]\)上连续，在\((a,b)\)内具有一阶和二阶导数，那么
\begin{enumerate}
\item 若在\((a,b)\)内\(f''(x)>0\)，则\(f(x)\)在\([a,b]\)上的图形是凹的；
\item 若在\((a,b)\)内\(f''(x)<0\)，则\(f(x)\)在\([a,b]\)上的图形是凸的.
\end{enumerate}
\begin{proof}
在情形1，设\(x_1\)和\(x_2\)为\([a,b]\)内任意两点，且\(x_1 < x_2\)，记\(\frac{x_1 + x_2}{2} = x_0\)，并记\(x_2 - x_0 = x_0 - x_1 = h\)，则\(x_1 = x_0 - h\)，\(x_2 = x_0 + h\)，由拉格朗日中值公式，得\[
f(x_0 + h) - f(x_0) = f'(x_0 + \theta_1 h) h,
\]\[
f(x_0) - f(x_0 - h) = f'(x_0 - \theta_2 h) h,
\]其中\(0 < \theta_1 < 1\)，\(0 < \theta_2 < 1\).两式相减，即得\[
f(x_0 + h) + f(x_0 - h) - 2 f(x_0)
= [ f'(x_0 + \theta_1 h) - f'(x_0 - \theta_2 h) ] h.
\]对\(f'(x)\)在区间\([x_0 - \theta_2 h,x_0 + \theta_1 h]\)上再利用拉格朗日中值公式，得\[
[ f'(x_0 + \theta_1 h) - f'(x_0 - \theta_2 h) ] h
= f''(\xi) (\theta_1 + \theta_2) h^2,
\]其中\(x_0 - \theta_2 h < \xi < x_0 + \theta_1 h\).按情形1的假设，\(f''(\xi) > 0\)，故有\[
f(x_0 + h) + f(x_0 - h) - 2 f(x_0) > 0,
\]即\[
\frac{f(x_0 + h) + f(x_0 - h)}{2} > f(x_0),
\]亦即\[
\frac{f(x_1) + f(x_2)}{2} > f\left(\frac{x_1 + x_2}{2}\right),
\]所以\(f(x)\)在\([a,b]\)上的图形是凹的.

类似地可证情形2.
\end{proof}
\end{theorem}

\begin{definition}
一般的，设\(y=f(x)\)在区间\(I\)上连续，\(x_0\)是\(I\)的内点\footnote{区间\(I\)的内点是指除端点外的\(I\)内的点}.
如果曲线\(y=f(x)\)在经过点\((x_0,f(x_0))\)时，曲线的凹凸性改变了，那么就称点\((x_0,f(x_0))\)为这曲线的\DefineConcept{拐点}.
\end{definition}

\begin{example}
函数\(f(x) = x^3\)以\(x=0\)为拐点.
函数\(g(x) = \abs{x(x-1)}\)以\(x=0\)和\(x=1\)为拐点.
\end{example}

由\cref{theorem:微分中值定理.曲线凹凸的判定} 可知，由\(f''(x)\)的符号可以判定曲线的凹凸性.
因此，如果\(f''(x)\)在\(x_0\)的左右两侧邻近异号，那么点\((x_0,f(x_0))\)就是曲线的一个拐点，
所以，要寻找拐点，只要找出\(f''(x)\)符号发生变化的分界点即可.
如果\(f(x)\)在区间\((a,b)\)内具有二阶连续导数，那么在这样的分界点处必然有\(f''(x)=0\)；
除此以外，\(f(x)\)的二阶导数不存在的点，也有可能是\(f''(x)\)的符号发生变化的分界点.

{\color{red}综合以上分析，我们可以按下列步骤来判定区间\(I\)上的连续曲线\(y=f(x)\)的拐点：
\begin{enumerate}
\item 求\(f''(x)\)；

\item 令\(f''(x) = 0\)，解出这个方程在区间\(I\)内的实根，
并求出在区间\(I\)内\(f''(x)\)不存在的点；

\item 对于上一步中求出的每一个实根或二阶导数不存在的点\(x_0\)，
检查\(f''(x)\)在\(x_0\)左右两侧邻近的符号，
那么当两侧的符号相反时，点\((x_0,f(x_0))\)就是拐点；
当两侧的符号相同时，点\((x_0,f(x_0))\)不是拐点.
\end{enumerate}}

\begin{example}
证明：当\(x>0\)，\(y>0\)，\(x \neq y\)，且\(n>1\)时，
有\begin{equation}\label{equation:微分中值定理.平均数的比较1}
\frac{1}{2} (x^n+y^n) > \left(\frac{x+y}{2}\right)^n
\end{equation}成立.
\begin{proof}
设\(f(x) = x^n\)，那么\(f'(x) = n x^{n-1}\)，\(f''(x) = n(n-1) x^{n-2}\).
由指数函数的性质可知，
当\(x > 0\)时，\(\forall \mu \in \mathbb{R}\)都有\(x^{\mu} > 0\)成立，
故当\(n > 1\)时，\(n(n-1)>0\)，\(f''(x) = n(n-1) x^{n-1} > 0\)成立，
即\(f(x)\)在\((0,+\infty)\)上是凹函数，
那么\(\forall x,y>0\)，
只要\(x \neq y\)，
就有\[
	\frac{f(x)+f(y)}{2} = \frac{x^n+y^n}{2}
	> \left(\frac{x+y}{2}\right)^n = f\left(\frac{x+y}{2}\right)
\]成立.
\end{proof}
\end{example}

\begin{example}
证明：当\(x \neq y\)时，有\begin{equation}
\frac{e^x + e^y}{2} > e^{\frac{x+y}{2}}.
\end{equation}
\begin{proof}
设\(f(x) = e^x\)，那么\(f'(x) = f''(x) = e^x > 0\ (x\in\mathbb{R})\)，可知\(f(x)\)是凹函数.
因此\[
f\left(\frac{x+y}{2}\right) = e^{\frac{x+y}{2}}
< \frac{e^x+e^y}{2} = \frac{f(x)+f(y)}{2}.
\qedhere
\]
\end{proof}
\end{example}
