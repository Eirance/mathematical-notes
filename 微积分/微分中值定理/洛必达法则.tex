\section{洛必达法则}
如果当\(x \to a\)（或\(x \to \infty\)）时，
两个函数\(f(x)\)与\(F(x)\)都趋于零或都趋于无穷大，
那么极限\(\lim\frac{f(x)}{F(x)}\)可能存在，也可能不存在.
通常把这种极限叫做\DefineConcept{未定式}，
并简记为\(\frac{0}{0}\)或\(\frac{\infty}{\infty}\).
对于这类极限，即是它存在也不能用“商的极限等于极限的商”这一法则.
下面我们将根据柯西中值定理来推出求这类极限的一种简便且重要的方法.

我们着重讨论\(x \to a\)时的未定式\(\frac{0}{0}\)的情形，关于这情形有以下定理：
\begin{theorem}\label{theorem:微分中值定理.洛必达法则1}
%@see: 《高等数学（第六版 上册）》 P135 定理1
设函数\(f\colon D\to\mathbb{R}\)和\(F\colon D\to\mathbb{R}\)都在点\(a\)的某个去心邻域中有定义.
如果\begin{itemize}
	\item \(\lim_{x\to a} f(x) = \lim_{x\to a} F(x) = 0\)；
	\item 在点\(a\)的某去心邻域内，\(f'(x)\)及\(F'(x)\)都存在且\(F'(x) \neq 0\)；
	\item \(\lim_{x \to a} \frac{f'(x)}{F'(x)}\)存在（或为无穷大），
\end{itemize}
那么\[
	\lim_{x \to a} \frac{f(x)}{F(x)}
	= \lim_{x \to a} \frac{f'(x)}{F'(x)}.
\]
\begin{proof}
因为\(\lim_{x\to a} \frac{f(x)}{F(x)}\)与\(f(a)\)及\(F(a)\)无关，
所以可以假定\(f(a)=F(a)=0\)，
于是由条件1、2可知，\(f(x)\)及\(F(x)\)在点\(a\)的某一邻域内是连续的.
设\(x\)是这邻域内的一点，
那么在以\(x\)及\(a\)为端点的区间上，
\hyperref[theorem:微分中值定理.柯西中值定理]{柯西中值定理}的条件均满足，
因此有\[
	\frac{f(x)}{F(x)}
	= \frac{f(x)-f(a)}{F(x)-F(a)}
	= \frac{f'(\xi)}{F'(\xi)}
	\quad(\text{\(\xi\)在\(x\)与\(a\)之间}).
\]
令\(x \to a\)，这时\(\xi \to a\)，再根据条件3便得要证的结论.
\end{proof}
\end{theorem}
像这样，在一定条件下，
通过分子分母分别求导再求极限来确定未定式的值的方法，
称为\DefineConcept{洛必达法则}（L'Hospital's rule）.

如果\(\frac{f'(x)}{F'(x)}\)当\(x \to a\)时仍属\(\frac{0}{0}\)型，
且这时\(f'(x)\)和\(F'(x)\)能满足定理中\(f(x)\)和\(F(x)\)所要满足的条件，
那么可以继续施用洛必达法则先确定\(\lim_{x \to a} \frac{f'(x)}{F'(x)}\)，
从而确定\(\lim_{x \to a} \frac{f(x)}{F(x)}\)，即\[
	\lim_{x \to a} \frac{f(x)}{F(x)}
	= \lim_{x \to a} \frac{f'(x)}{F'(x)}
	= \lim_{x \to a} \frac{f''(x)}{F''(x)};
\]
且可以此类推.

\begin{example}
%@see: 《高等数学（第六版 上册）》 P136 例1
求\(\lim_{x\to0} \frac{\sin ax}{\sin bx}\ (b \neq 0)\).
\begin{solution}
\(\lim_{x\to0} \frac{\sin ax}{\sin bx}
= \lim_{x\to0} \frac{a \cos ax}{b \cos bx}
= \frac{a}{b}\).
\end{solution}
\end{example}

\begin{example}
%@see: 《高等数学（第六版 上册）》 P136 例2
求\(\lim_{x\to1} \frac{x^3-3x+2}{x^3-x^2-x+1}\).
\begin{solution}
\(\lim_{x\to1} \frac{x^3-3x+2}{x^3-x^2-x+1}
= \lim_{x\to1} \frac{3x^2-3}{3x^2-2x-1}
= \lim_{x\to1} \frac{6x}{6x-2}
= \frac32\).
\end{solution}
\end{example}

\begin{remark}
在上例中，\(\lim_{x\to1} \frac{6x}{6x-2}\)已经不是未定式，
不能再对它应用洛必达法则，否则会导致错误结果.
以后在使用洛必达法则时，一定要经常注意极限是否还是未定式，
如果不是未定式，就不能应用洛必达法则.
\end{remark}

\begin{example}
%@see: 《高等数学（第六版 上册）》 P136 例3
求\(\lim_{x\to0} \frac{x-\sin x}{x^3}\).
\begin{solution}
\(\lim_{x\to0} \frac{x-\sin x}{x^3}
= \lim_{x\to0} \frac{1-\cos x}{3x^2}
= \lim_{x\to0} \frac{\sin x}{6x}
= \frac16\).
\end{solution}
\end{example}

\begin{example}
求\(\lim_{x\to-\frac\pi2} (\sec x+\tan x)\).
\begin{solution}
\(\lim_{x\to-\frac\pi2} (\sec x+\tan x)
= \lim_{x\to-\frac\pi2} \frac{1+\sin x}{\cos x}
= \lim_{x\to-\frac\pi2} \frac{\cos x}{-\sin x}
= 0\).
\end{solution}
\end{example}

\begin{example}
求\(\lim_{x\to\pi} (\csc x+\cot x)\).
\begin{solution}
\(\lim_{x\to\pi} (\csc x+\cot x)
= \lim_{x\to\pi} \frac{1+\cos x}{\sin x}
= \lim_{x\to\pi} \frac{-\sin x}{\cos x}
= 0\).
\end{solution}
\end{example}

我们指出，对于\(x\to\infty\)时的未定式\(\frac{0}{0}\)
以及对于\(x \to a\)或\(x\to\infty\)时的未定式\(\frac{\infty}{\infty}\)，
也有相应的洛必达法则.
例如，对于\(x\to\infty\)时的未定式\(\frac{0}{0}\)有以下定理.
\begin{theorem}\label{theorem:微分中值定理.洛必达法则2}
%@see: 《高等数学（第六版 上册）》 P136 定理2
设\begin{enumerate}
	\item \(\lim_{x\to\infty} f(x) = \lim_{x\to\infty} F(x) = 0\)；
	\item 当\(\abs{x}>N\)时，\(f'(x)\)与\(F'(x)\)都存在，且\(F'(x) \neq 0\)；
	\item \(\lim_{x\to\infty} \frac{f'(x)}{F'(x)}\)存在（或为无穷大），
\end{enumerate}
那么\[
	\lim_{x\to\infty} \frac{f(x)}{F(x)}
	= \lim_{x\to\infty} \frac{f'(x)}{F'(x)}.
\]
\end{theorem}

\begin{remark}
洛必达法则只是未定式极限存在的充分不必要条件.
例如，对于极限\[
	\lim_{x\to\infty} \frac{x+\sin x}{x},
\]
易见\[
	\lim_{x\to\infty} (x+\sin x)
	= \lim_{x\to\infty} x
	= \infty,
	\qquad
	(x+\sin x)' = 1+\cos x, \qquad
	x' = 1.
\]
虽然极限\[
	\lim_{x\to\infty}\frac{(x+\sin x)'}{x'} = \lim_{x\to\infty}(1+\cos x)
\]不存在，
但原极限存在：\[
	\lim_{x\to\infty} \frac{x+\sin x}{x}
	= 1 + \lim_{x\to\infty} \frac{\sin x}{x}
	= 1 + 0 = 1.
\]
\end{remark}

\begin{remark}
在运用洛必达法则时必须注意其条件是否得到满足.
例如，
极限\[
	\lim_{x\to\infty} \frac{x+\sin x \cos x}{e^{\sin x}(x+\sin x \cos x)}
	= \lim_{x\to\infty} \frac{1}{e^{\sin x}}
\]不存在.
但极限\[
	L = \lim_{x\to\infty} \frac{(x+\sin x \cos x)'}{[e^{\sin x}(x+\sin x \cos x)]'}
	= \lim_{x\to\infty} \frac{2\cos^2 x}{e^{\sin x}\cos x(2\cos x + x + \sin x \cos x)},
\]其中分母的\(\cos x\)不满足恒不为零的条件.
在无视这个错误的情况下继续求解居然算得\[
	L = \lim_{x\to\infty} \frac{2\cos x}{e^{\sin x}(2\cos x + x + \sin x \cos x)} = 0.
\]
这显然是错误的.
\end{remark}

\begin{example}
求\(\lim_{x\to+\infty} \frac{\frac{\pi}{2} - \arctan x}{\frac{1}{x}}\).
\begin{solution}
\(\lim_{x\to+\infty} \frac{\frac{\pi}{2} - \arctan x}{\frac{1}{x}}
= \lim_{x\to+\infty} \frac{-\frac{1}{1+x^2}}{-\frac{1}{x^2}}
= \lim_{x\to+\infty} \frac{x^2}{1+x^2} = 1\).
\end{solution}
\end{example}

\begin{example}
求\(\lim_{x\to+\infty} \frac{\ln x}{x^n}\ (n>0)\).
\begin{solution}
\(\lim_{x\to+\infty} \frac{\ln x}{x^n}
= \lim_{x\to+\infty} \frac{\frac{1}{x}}{n x^{n-1}}
= \lim_{x\to+\infty} \frac{1}{n x^n} = 0\).
\end{solution}
\end{example}

\begin{example}
求\(\lim_{x\to+\infty} \frac{x^n}{e^{\lambda x}}\).
\begin{solution}
相继应用洛必达法则\(n\)次，
得\begin{align*}
	\lim_{x\to+\infty} \frac{x^n}{e^{\lambda x}}
	&= \lim_{x\to+\infty} \frac{n x^{n-1}}{\lambda e^{\lambda x}}
	= \lim_{x\to+\infty} \frac{n(n-1) x^{n-2}}{\lambda^2 e^{\lambda x}} \\
	&= \dotsb = \lim_{x\to+\infty} \frac{n!}{\lambda^n e^{\lambda x}}
	= 0.
\end{align*}
\end{solution}
\end{example}

其他还有一些\(0 \cdot \infty\)、\(\infty - \infty\)、\(0^0\)、\(1^\infty\)、\(\infty^0\)型的未定式，也可通过\(\frac{0}{0}\)或\(\frac{\infty}{\infty}\)型的未定式来计算.

形如\(\infty - \infty\)的未定式，通分为\(\frac{0}{0}\)或\(\frac{\infty}{\infty}\)型；
形如\(0 \cdot \infty\)的未定式，将其中一个因子取倒数作为分母，化为\(\frac{0}{0}\)或\(\frac{\infty}{\infty}\)型；
形如\(0^0\)、\(1^\infty\)、\(\infty^0\)的未定式，先取对数，化为\(0 \cdot \infty\)型.

\begin{example}\label{example:微分中值定理.洛必达法则.零乘无穷大型1}
%@see: 《高等数学（第六版 上册）》 P137 例7
求\(\lim_{x\to0^+} x^n \ln x\ (n > 0)\).
\begin{solution}
这是未定式\(0\cdot\infty\).
因为\(x^n \ln x = \frac{\ln x}{\frac{1}{x^n}}\)，
当\(x\to0^+\)时，上式右端是未定式\(\frac{\infty}{\infty}\)，
应用洛必达法则，
得\(\lim_{x\to0^+} x^n \ln x
= \lim_{x\to0^+} \frac{\ln x}{x^{-n}}
= \lim_{x\to0^+} \frac{x^{-1}}{-nx^{-n-1}}
= \lim_{x\to0^+} \frac{-x^n}{n}
= 0\).
\end{solution}
\end{example}

\begin{example}\label{example:微分中值定理.洛必达法则.零次方零型1}
%@see: 《高等数学（第六版 上册）》 P138 例9
求\(\lim_{x\to0^+}{x^x}\).
\begin{solution}
这是未定式\(0^0\).
设\(y = x^x\)，取对数得\(\ln y = x \ln x\).
当\(x\to0^+\)时，上式右端是未定式\(0\cdot\infty\).
应用\cref{example:微分中值定理.洛必达法则.零乘无穷大型1} 的结果，
得\[
	\lim_{x\to0^+} \ln y
	= \lim_{x\to0^+} (x \ln x) = 0.
\]
因为\(y = e^{\ln y}\)，
而\(\lim_{x\to0^+} y
= \lim_{x\to0^+} e^{\ln y}
= e^{\lim_{x\to0^+} \ln y}\)，
所以\[
	\lim_{x\to0^+} x^x
	= \lim_{x\to0^+} y
	= e^0
	= 1.
\]
\end{solution}
\end{example}

洛必达法则是求未定式的一种有效方法，但最好能与其他求极限的方法结合使用.
例如能化简时应尽量先化简，可以应用等价无穷小替代或重要极限时应尽可能应用，这样可以使运算简便.

\begin{example}\label{example:微分中值定理.洛必达法则.零乘无穷大型2}
求\(\lim_{x\to+\infty} x p^x\ (0<p<1)\).
\begin{solution}
这是未定式\(0\cdot\infty\).
因为\(x p^x =  \frac{x}{(1/p)^x}\)，
当\(x\to+\infty\)时，上式右端是未定式\(\frac{\infty}{\infty}\)，
应用洛必达法则，
得\[
	\lim_{x\to+\infty} x p^x
	= \lim_{x\to+\infty} \frac{x}{(1/p)^x}
	= \lim_{x\to+\infty} \frac{1}{(1/p)^x \ln(1/p)}
	= \lim_{x\to+\infty} \frac{p^x}{\ln(1/p)}
	= 0.
\]
\end{solution}
\end{example}

\begin{example}
求\(\lim_{x\to0} \frac{a^{x^2}-b^{x^2}}{(a^x-b^x)^2}\ (0<a<b)\).
\begin{solution}
这里我们先化简，再利用洛必达法则：\begin{align*}
	\lim_{x\to0} \frac{a^{x^2}-b^{x^2}}{(a^x-b^x)^2}
	&= \lim_{x\to0} \frac{a^{x^2}-b^{x^2}}{x^2}
		\cdot \lim_{x\to0} \left(\frac{x}{a^x-b^x}\right)^2 \\
	&= \lim_{x\to0^+} \frac{a^x-b^x}{x}
		\cdot \lim_{x\to0} \left(\frac{x}{a^x-b^x}\right)^2 \\
	&= \lim_{x\to0} \frac{x}{a^x-b^x} \\
	&= \lim_{x\to0} \frac{1}{a^x \ln a - b^x \ln b}
	= \frac{1}{\ln(a/b)}.
\end{align*}
\end{solution}
\end{example}
