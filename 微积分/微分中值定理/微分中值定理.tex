\section{微分中值定理}
\subsection{费马引理}
\begin{lemma}[费马引理]\label{theorem:微分中值定理.费马引理}
设函数\(f(x)\)在点\(x_0\)的某邻域\(U(x_0)\)内有定义，
并且在\(x_0\)处可导.
如果对任意的\(x \in U(x_0)\)，有
\[
    f(x) \leq f(x_0)
    \quad\text{或}\quad
    f(x) \geq f(x_0),
\]
那么\(f'(x_0) = 0\).
\begin{proof}
不妨设\(x \in U(x_0)\)时，
\(f(x) \leq f(x_0)\)，
于是，对于\(x_0 + \increment x \in U(x_0)\)，有\[
    f(x_0 + \increment x) \leq f(x_0),
\]
从而当\(\increment x > 0\)时，\[
    \frac{f(x_0 + \increment x) - f(x_0)}{\increment x} \leq 0;
\]
当\(\increment x < 0\)时，\[
    \frac{f(x_0 + \increment x) - f(x_0)}{\increment x} \geq 0.
\]
根据函数\(f(x)\)在\(x_0\)可导的条件及极限的保号性，便得到\[
    f'(x_0) = f'_+(x_0)
    = \lim_{\increment x\to0^+}
    \frac{f(x_0 + \increment x) - f(x_0)}{\increment x} \leq 0,
\]\[
    f'(x_0) = f'_-(x_0)
    = \lim_{\increment x\to0^-}
    \frac{f(x_0 + \increment x) - f(x_0)}{\increment x} \geq 0.
\]
所以，\(f'(x_0) = 0\).

同理，对于当\(x \in U(x_0)\)时，
\(f(x) \geq f(x_0)\)的情形，可以类似地证明.
\end{proof}
\end{lemma}

\subsection{罗尔定理}
\begin{figure}[ht]
	\centering
	\begin{tikzpicture}
		\begin{axis}[
			xmin=0,xmax=8,
			ymin=0,ymax=3,
			axis lines=middle,
			xlabel=$x$,
			ylabel=$y$,
			enlarge x limits=0.1,
			enlarge y limits=0.1,
			ticks=none,
		]
			\addplot[domain=1:7.283,color=blue]{.5*sin(deg(x-1))+2};
			\draw(1,2)coordinate(A)node[left]{$A$}
				(1,0)coordinate(a)node[below]{$a$}
				(2.571,2.5)coordinate(C)node[above]{$C$}
				(2.571,0)coordinate(c)node[below]{$\xi$}
				(5.713,1.5)node[below]{$D$}
				(7.283,2)coordinate(B)node[right]{$B$}
				(7.283,0)coordinate(b)node[below]{$b$};
			\draw[dashed,black!30](1,2)--(7.283,2)
				(A)--(a) (C)--(c) (B)--(b);
		\end{axis}
	\end{tikzpicture}
	\caption{}
	\label{figure:微分中值定理.罗尔定理的几何意义}
\end{figure}

观察\cref{figure:微分中值定理.罗尔定理的几何意义}，
设曲线弧\(\Arc{AB}\)是函数\(y=f(x)\ (a\leq x\leq b)\)的图形.
这是一条连续的曲线弧，除端点外，处处有不垂直于\(x\)的切线，
且两个端点的纵坐标相等，即\(f(a)=f(b)\).
可以发现在曲线弧的最高点\(C\)处或最低点\(D\)处，曲线有水平的切线.
如果记\(C\)的横坐标为\(\xi\)，那么就有\(f'(\xi)=0\).
现在用分析语言把这个几何现象描述出来，就可得下面的罗尔定理.

\begin{theorem}[罗尔定理]\label{theorem:微分中值定理.罗尔定理}
如果函数\(f(x)\)满足
\begin{enumerate}
	\item 在闭区间\([a,b]\)上连续（即\(f \in C[a,b]\)）；
	\item 在开区间\((a,b)\)内可导（即\(f \in D(a,b)\)）；
	\item 在区间端点处的函数值相等，即\(f(a)=f(b)\)，
\end{enumerate}
那么\(\exists \xi \in (a,b)\)使得\(f'(\xi) = 0\).
\begin{proof}
由于\(f(x)\)在闭区间\([a,b]\)上连续，
根据闭区间上连续函数的最大值最小值定理，
\(f(x)\)在闭区间\([a,b]\)上必定取得它的最大值\(M\)和最小值\(m\).
这样，只有两种可能情形：
\begin{enumerate}
	\item \(M=m\).
		这时\(f(x)\)在区间\([a,b]\)上是常数函数，即\(f(x)=M\).
		由此，\(\forall x\in(a,b)\)，有\(f'(x)=0\).
		因此，任取\(\xi\in(a,b)\)，有\(f'(\xi)=0\).

	\item \(M>m\).
		因为\(f(a)=f(b)\)，
		所以\(M\)和\(m\)这两个数中，
		至少有一个不等于\(f(x)\)在区间\([a,b]\)的端点处的函数值.
		不妨设\(M \neq f(a)\)，
		那么必定在开区间\((a,b)\)内有一点\(\xi\)使\(f(\xi)=M\).
		因此，\(\forall x\in[a,b]\)，
		有\(f(x) \leq f(\xi)\)，从而由费马引理可知\(f'(\xi)=0\).
		\qedhere
\end{enumerate}
\end{proof}
\end{theorem}

\begin{corollary}
设函数\(f \in D(a,b)\)，且\[
\lim_{x \to a^+} f(x)
= \lim_{x \to b^-} f(x),
\]则\(\exists\xi\in(a,b)\)，使得\(f'(\xi) = 0\).
\end{corollary}

\begin{example}
若方程\(a_0 x^n + a_1 x^{n-1} + \dotsb + a_{n-1} x = 0\)有一个正根\(x = x_0\)，证明：方程\(a_0 n x^{n-1} + a_1 (n-1) x^{n-2} + \dotsb + a_{n-1} = 0\)必有一个小于\(x_0\)的正根.
\begin{proof}
设\(f(x) = a_0 x^n + a_1 x^{n-1} + \dotsb + a_{n-1} x\)，则\(f(0) = f(x_0) = 0\)，而\[
f'(x) = a_0 n x^{n-1} + a_1 (n-1) x^{n-2} + \dotsb + a_{n-1}.
\]根据罗尔定理，\(\exists \xi \in (0,x_0)\)使得\(f'(\xi) = 0\)，即\(\xi\)就是小于\(x_0\)的正根.
\end{proof}
\end{example}

\subsection{拉格朗日中值定理}
\begin{theorem}[拉格朗日中值定理]\label{theorem:微分中值定理.拉格朗日中值定理}
如果函数\(f(x)\)满足
\begin{enumerate}
\item 在闭区间\([a,b]\)上连续（即\(f \in C[a,b]\)）；
\item 在开区间\((a,b)\)内可导（即\(f \in D(a,b)\)）；
\end{enumerate}
那么\(\exists \xi \in (a,b)\)使得
\begin{equation}\label{equation:微分中值定理.拉格朗日中值公式}
f(b)-f(a)=f'(\xi) \cdot (b-a)
\end{equation}
成立.
\begin{proof}
令\[
	\phi(x)=f(x)-f(a)-\frac{f(b)-f(a)}{b-a}(x-a).
\]
不难得\(\phi(a)=\phi(b)=0\)，
\(\phi\in C[a,b]\cap D(a,b)\)，
且\[
	\phi'(x)=f'(x)-\frac{f(b)-f(a)}{b-a}.
\]
根据\hyperref[theorem:微分中值定理.罗尔定理]{罗尔定理}可知，
在\(\exists\xi\in(a,b)\)使得\(\phi'(\xi)=0\)，
即\[
	f'(\xi)-\frac{f(b)-f(a)}{b-a}=0,
	\quad\text{或}\quad
	\frac{f(b)-f(a)}{b-a}=f'(\xi),
\]
亦即\[
	f(b)-f(a)=f'(\xi)(b-a).
	\qedhere
\]
\end{proof}
\end{theorem}
\cref{equation:微分中值定理.拉格朗日中值公式} 叫做\DefineConcept{拉格朗日中值公式}.

设\(x\)为区间\([a,b]\)内一点，\(x+\increment x\)为这区间内的另一点（\(\increment x \gtrless 0\)），则\cref{equation:微分中值定理.拉格朗日中值公式} 在区间\([x,x+\increment x]\)（当\(\increment x>0\)时）或在区间\([x+\increment x,x]\)（当\(\increment x<0\)时）上就成为
\begin{equation}
f(x+\increment x) - f(x)
= f'(x+\theta \increment x) \cdot \increment x
\quad(0<\theta<1).
\end{equation}

如果记\(f(x)\)为\(y\)，\(\increment y = f(x+\increment x) - f(x)\)，则上式又可写成
\begin{equation}\label{equation:微分中值定理.有限增量公式}
\increment y = f'(x+\theta \increment x) \cdot \increment x
\quad(0<\theta<1).
\end{equation}
我们知道，函数的微分\(\dd{y} = f'(x) \cdot \increment x\)是函数的增量\(\increment y\)的近似表达式.
一般说来，以\(\dd{y}\)近似代替\(\increment y\)时所产生的误差只有当\(\increment x\to0\)时才趋于零；
而\cref{equation:微分中值定理.有限增量公式} 却给出了自变量取得有限增量\(\increment x\)（\(\abs{\increment x}\)不一定很小）时，函数增量\(\increment y\)的准确表达式.
因此，这个定理也叫做\DefineConcept{有限增量定理}，\cref{equation:微分中值定理.有限增量公式} 称为\DefineConcept{有限增量公式}.

\begin{example}\label{example:微分中值定理.拉格朗日中值定理.重要不等式1}
证明：当\(x>0\)时，\[
	\frac{x}{1+x} < \ln(1+x) < x.
\]
\begin{proof}
设\(f(t) = \ln(1+t)\)，
显然\(f(t)\)在区间\([0,x]\)上满足拉格朗日中值定理的条件，
那么存在\(\xi\in(0,x)\)
使得\[
	f(x)-f(0)=f'(\xi)\cdot(x-0).
\]
由于\(f(0)=0\)，
\(f'(\xi)=\frac{1}{1+\xi}\)，
故\[
	\ln(1+x) = \frac{x}{1+\xi}.
\]
又由\(0<\xi<x\)，
有\[
	\frac{x}{1+x}<\frac{x}{1+\xi}<x,
\]
所以\[
	\frac{x}{1+x}<\ln(1+x)<x, \quad x > 0.
	\qedhere
\]
\end{proof}
\end{example}

\begin{example}\label{example:微分中值定理.拉格朗日中值定理.欧拉--马歇罗尼常数}
试证：极限\[
	\lim_{n\to\infty} \left(\sum_{k=1}^n \frac{1}{k} - \ln n\right)
\]收敛.
\begin{proof}
记\(x_n = \sum_{k=1}^n \frac{1}{k} - \ln n\).

利用\cref{example:微分中值定理.拉格朗日中值定理.重要不等式1} 的结论，
任取\(n\in\mathbb{N}^+\)，
令\(x=\frac{1}{n}\)，
则有\[
	\frac{1}{n+1} < \ln(1+\frac{1}{n}) < \frac{1}{n}.
\]
因此\[
	x_{n+1} - x_n = \frac{1}{n+1} - \ln\frac{n+1}{n}
	= \frac{1}{n+1} - \ln(1+\frac{1}{n}) < 0,
\]
可知\(\{x_n\}\)是单调减少数列.
又因为\begin{align*}
	x_n &= 1 + \frac{1}{2} + \dotsb + \frac{1}{n} - \ln n \\
	&> \ln(1+1) + \ln(1+\frac{1}{2}) + \dotsb + \ln(1+\frac{1}{n}) - \ln n \\
	&= (\ln2-\ln1)+(\ln3-\ln2)+\dotsb+[\ln(n+1)-\ln n] - \ln n \\
	&= \ln(n+1) - \ln n
	= \ln(1+\frac{1}{n})
	> \frac{1}{n+1} > 0,
\end{align*}
可知\(\{x_n\}\)有界.
综上，根据\hyperref[theorem:极限.函数的单调有界定理]{单调有界定理}可知，
数列\(\{x_n\}\)收敛于有限值.
\end{proof}
\end{example}
\begin{remark}
我们把极限\(\lim_{n\to\infty} \left(\sum_{k=1}^n \frac{1}{k} - \ln n\right)\)
称为\DefineConcept{欧拉--马歇罗尼常数}（Euler--Mascheroni Constant），
记作\(\gamma\)，
其在数值上近似等于{0.577~216}.
%@Mathematica: N[EulerGamma, 6]
%@see: https://mathworld.wolfram.com/Euler-MascheroniConstant.html
\end{remark}

我们知道，如果函数\(f(x)\)在某一区间上是一个常数，
那么\(f(x)\)在该区间上的导数恒为零.作为拉格朗日中值定理的一个应用，
可以推出以上命题的逆命题也是成立的，即：
\begin{theorem}
如果函数\(f(x)\)在区间\(I\)上的导数恒为零，那么\(f(x)\)在区间\(I\)上是一个常数.
\end{theorem}

\begin{example}
证明恒等式：\[
\arcsin x + \arccos x = \frac{\pi}{2},
\quad -1 \leq x \leq 1.
\]
\begin{proof}
设\(f(t) = \arcsin t + \arccos t\ (-1 \leq t \leq 1)\)，求导得\[
	f'(t) = \dv{t} \arcsin t + \dv{t} \arccos t
	= \frac{1}{\sqrt{1-t^2}} - \frac{1}{\sqrt{1-t^2}} = 0.
\]
这说明\(f(t)\)在区间\([-1,1]\)上是常数.

代入\(x=0\)得\(\arcsin 0 = 0\)，\(\arccos 0 = \pi/2\)，那么\[
	f(x) = f(0) \equiv \arcsin 0 + \arccos 0 = \frac{\pi}{2},
	\quad -1 \leq x \leq 1.
	\qedhere
\]
\end{proof}
\end{example}

\begin{example}
\def\l{\lim_{x\to0}}%
计算极限\(\l \left[\sin x - \sin(\sin x)\right]\).
\begin{solution}
由\hyperref[theorem:微分中值定理.拉格朗日中值定理]{拉格朗日中值定理}，
\(\exists\xi\in(\sin x,x)\)使得\[
	\sin x - \sin(\sin x)
	= \cos\xi (x-\sin x).
\]
当\(x\to0\)时，\(\sin x\to0\)，
故\(\xi\to0\)，\(\cos\xi\to1\)，那么\[
	\l \left[\sin x - \sin(\sin x)\right]
	= \l \cos\xi \cdot \left(\l x - \l \sin x\right)
	= 1 \cdot (0-0) = 0.
\]
\end{solution}
\end{example}
本例也可直接根据\cref{theorem:极限.连续函数的极限3} 得到，
即直接将\(x=0\)代入函数\(f(x) = \sin x - \sin(\sin x)\)中.

\subsection{柯西中值定理}
\begin{theorem}[柯西中值定理]\label{theorem:微分中值定理.柯西中值定理}
如果函数\(f(x)\)及\(F(x)\)满足
\begin{enumerate}
	\item 在闭区间\([a,b]\)上连续（即\(f,g \in C[a,b]\)）；
	\item 在开区间\((a,b)\)内可导（即\(f,g \in D(a,b)\)）；
	\item 对\(\forall x\in(a,b)\)，有\(F'(x) \neq 0\)，
\end{enumerate}
那么在\((a,b)\)内至少有一点\(\xi\)，使等式
\begin{equation}
\frac{f(b)-f(a)}{F(b)-F(a)}=\frac{f'(\xi)}{F'(\xi)}
\end{equation}
成立.
\begin{proof}
因为\(F(b)-F(a)=F'(\eta)(b-a)\ (a<\eta<b)\)，
根据假定\(F'(\eta)\neq0\)，
又\(b-a\neq0\)，
所以\(F(b)-F(a)\neq0\).
令\[
	\phi(x)=f(x)-f(a)-\frac{f(b)-f(a)}{F(b)-F(a)}[F(x)-F(a)].
\]
不难得\(\phi(a)=\phi(b)=0\)，
\(\phi\in C[a,b]\cap D(a,b)\)，
且\[
	\phi'(x)=f'(x)-\frac{f(b)-f(a)}{F(b)-F(a)}\cdot F'(x).
\]
根据\hyperref[theorem:微分中值定理.罗尔定理]{罗尔定理}可知，
在\(\exists\xi\in(a,b)\)使得\(\phi'(\xi)=0\)，
即\[
	f'(\xi)-\frac{f(b)-f(a)}{F(b)-F(a)}\cdot F'(\xi)=0,
\]
亦即\[
	\frac{f(b)-f(a)}{F(b)-F(a)}=\frac{f'(\xi)}{F'(\xi)}.
	\qedhere
\]
\end{proof}
\end{theorem}

我们把\hyperref[theorem:微分中值定理.罗尔定理]{罗尔定理}、
\hyperref[theorem:微分中值定理.拉格朗日中值定理]{拉格朗日中值定理}%
和\hyperref[theorem:微分中值定理.柯西中值定理]{柯西中值定理}%
统称为\DefineConcept{微分中值定理}.

\subsection{达布定理}
一般来说，一个可微函数的导数并不一定连续，
但是导函数却像闭区间上的连续函数一样，
服从自己的“零点定理”和“介值定理”.

\begin{theorem}[达布零点定理]\label{theorem:微分中值定理.达布定理1}
%@see: 《数学分析教程》（史济怀） P150 定理3.4.5(1)
设函数\(f \in D(a,b)\)，\(a<x_1<x_2<b\).
如果\(f'(x_1) \cdot f'(x_2) < 0\)，
那么\[
	(\exists\xi\in(x_1,x_2))
	[f'(\xi) = 0].
\]
\begin{proof}
不妨设\(f'(x_1)<0,f'(x_2)>0\).
那么根据\hyperref[theorem:极限.函数极限的局部保号性1]{函数极限的局部保号性}，
\(\exists\delta_1,\delta_2>0\)，
使得\[
	U(x_1,\delta_1),U(x_2,\delta_2)\subset(a,b),
\]
且\[
	\begin{split}
		(\forall x \in U(x_1,\delta_1))
		\left[\frac{f(x)-f(x_1)}{x-x_1}<0\right], \\
		(\forall x \in U(x_2,\delta_2))
		\left[\frac{f(x)-f(x_2)}{x-x_2}>0\right].
	\end{split}
\]

任取实数\(\alpha \in U(x_1,\delta_1)\)和\(\beta \in U(x_2,\delta_2)\)，
使得\(x_1<\alpha<\beta<x_2\)，
由上可知\[
	\begin{split}
		\frac{f(\alpha)-f(x_1)}{\alpha-x_1}<0
		\iff
		f(\alpha)-f(x_1)<0
		\iff
		f(\alpha)<f(x_1), \\
		\frac{f(\beta)-f(x_2)}{\beta-x_2}>0
		\iff
		f(\beta)-f(x_2)<0
		\iff
		f(\beta)<f(x_2).
	\end{split}
\]
这就是说\(f(x_1)\)和\(f(x_2)\)都不是\(f\)在\([x_1,x_2]\)上的最小值.

由于\(f \in D(a,b)\)而\([x_1,x_2]\subset(a,b)\)，
所以\(f \in D[x_1,x_2]\)，
那么根据\cref{theorem:导数与微分.函数可导性与连续性的关系}
有\(f \in C[x_1,x_2]\).
根据\hyperref[theorem:极限.最值定理]{魏尔斯特拉斯最值定理}，
有\[
	(\exists\xi\in(x_1,x_2))
	(\forall x\in(x_1,x_2))
	[f(\xi) \leq f(x)].
\]
那么利用\hyperref[theorem:微分中值定理.费马引理]{费马引理}可知\(f'(\xi)=0\).
\end{proof}
\end{theorem}

我们可以将\cref{theorem:微分中值定理.达布定理1} 作一番推广.
\begin{theorem}[达布介值定理]\label{theorem:微分中值定理.达布定理2}
%@see: 《数学分析教程》（史济怀） P150 定理3.4.5(1)
设函数\(f \in D[a,b]\)，且\(f'(a) < f'(b)\).
那么\(\forall\lambda\in(f'(A),f'(b))\)，\(\exists\xi\in(a,b)\)，
使得\[
	f'(\xi) = \lambda.
\]
\begin{proof}
令\(F(x) = f(x) - \lambda x\ (a \leq x \leq b)\).
那么\(F \in D[a,b]\)，且\[
	F'(a) = f'(a) - \lambda < 0, \qquad
	F'(b) = f'(b) - \lambda > 0.
\]
根据\cref{theorem:微分中值定理.达布定理1} 就有\(\exists\xi\in[a,b]\)使得\[
	F'(\xi)=0,
\]
即\(f'(x) = \lambda\).
\end{proof}
\end{theorem}

\begin{theorem}
%@see: 《数学分析教程》（史济怀） P150 定理3.4.5(2)
设\(f \in D[a,b]\)，那么导函数\(f'\)没有第一类间断点.
\begin{proof}
用反证法.
设\(x_0\)是\(f'\)的一个第一类间断点，
那么\(f'(x_0^+)\)和\(f'(x_0^-)\)都存在.

因为\(f \in D[a,b]\)，
由\hyperref[theorem:微分中值定理.拉格朗日中值定理]{拉格朗日中值定理}，
可得\[
	f'(x_0)
	= f'_+(x_0)
	= \lim_{x \to x_0^+} \frac{f(x)-f(x_0)}{x-x_0}
	= \lim_{x \to x_0^+} \frac{f'(\xi) (x-x_0)}{x-x_0}
	= \lim_{x \to x_0^+} f'(\xi)
	\quad(x_0<\xi<x).
\]
由于当\(x \to x_0^+\)时，\(\xi \to x_0^+\)，
且已知\(f'(x_0^+)\)存在，
所以有\[
	f'(x_0)=f'(x_0^+).
\]
同理可证\(f'(x_0)=f'(x_0^-)\).
由此可知\(f'\)在点\(x_0\)连续，
而这与\(x_0\)是\(f'\)的间断点矛盾！
\end{proof}
\end{theorem}
